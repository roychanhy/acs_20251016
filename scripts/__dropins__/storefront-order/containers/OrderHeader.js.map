{"version":3,"file":"OrderHeader.js","sources":["/@dropins/storefront-order/src/data/transforms/transform-customer-address-input.ts","../../node_modules/@adobe-commerce/elsie/src/icons/OrderSuccess.svg","/@dropins/storefront-order/src/hooks/containers/useOrderHeader.tsx","/@dropins/storefront-order/src/containers/OrderHeader/OrderHeader.tsx","/@dropins/storefront-order/src/components/OrderHeader/OrderHeader.tsx"],"sourcesContent":["/********************************************************************\n * ADOBE CONFIDENTIAL\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { OrderAddressModel } from '@/order/data/models';\n\nexport function transformCustomerAddressInput(address: OrderAddressModel) {\n  return {\n    region: {\n      region_id: address?.regionId ? Number(address?.regionId) : null,\n      region: address?.region,\n    },\n    city: address?.city,\n    company: address?.company,\n    country_code: address?.countryCode,\n    firstname: address?.firstName,\n    lastname: address?.lastName,\n    middlename: address?.middleName,\n    postcode: address?.postCode,\n    street: address?.street,\n    telephone: address?.telephone,\n    custom_attributesV2:\n      address?.customAttributes?.map((attr) => ({\n        attribute_code: attr.code,\n        value: attr.value,\n      })) || [],\n  };\n}\n","import * as React from \"react\";\nconst SvgOrderSuccess = (props) => /* @__PURE__ */ React.createElement(\"svg\", { width: 24, height: 24, viewBox: \"0 0 24 24\", fill: \"none\", xmlns: \"http://www.w3.org/2000/svg\", ...props }, /* @__PURE__ */ React.createElement(\"g\", { clipPath: \"url(#clip0_4797_15077)\" }, /* @__PURE__ */ React.createElement(\"path\", { vectorEffect: \"non-scaling-stroke\", d: \"M10.15 20.85L1.5 17.53V6.63L10.15 10V20.85Z\", stroke: \"currentColor\", strokeLinecap: \"round\", strokeLinejoin: \"round\" }), /* @__PURE__ */ React.createElement(\"path\", { vectorEffect: \"non-scaling-stroke\", d: \"M1.5 6.63001L10.15 3.20001L18.8 6.63001L10.15 10L1.5 6.63001Z\", stroke: \"currentColor\", strokeLinecap: \"round\", strokeLinejoin: \"round\" }), /* @__PURE__ */ React.createElement(\"path\", { vectorEffect: \"non-scaling-stroke\", d: \"M6.17969 4.77002L14.8297 8.15002V11.47\", stroke: \"currentColor\", strokeLinecap: \"round\", strokeLinejoin: \"round\" }), /* @__PURE__ */ React.createElement(\"path\", { vectorEffect: \"non-scaling-stroke\", d: \"M18.7896 12.64V6.63L10.1396 10V20.85L14.8296 19.05\", stroke: \"currentColor\", strokeLinejoin: \"round\" }), /* @__PURE__ */ React.createElement(\"path\", { className: \"success-icon\", vectorEffect: \"non-scaling-stroke\", d: \"M15.71 17.26C15.71 15.38 17.23 13.86 19.11 13.86C20.99 13.86 22.51 15.38 22.51 17.26C22.51 19.14 20.99 20.66 19.11 20.66C17.23 20.66 15.71 19.14 15.71 17.26Z\", stroke: \"currentColor\" }), /* @__PURE__ */ React.createElement(\"path\", { className: \"success-icon\", vectorEffect: \"non-scaling-stroke\", d: \"M17.4805 17.49L18.5605 18.41L20.7205 16.33\", stroke: \"currentColor\", strokeLinecap: \"square\", strokeLinejoin: \"round\" })), /* @__PURE__ */ React.createElement(\"defs\", null, /* @__PURE__ */ React.createElement(\"clipPath\", { id: \"clip0_4797_15077\" }, /* @__PURE__ */ React.createElement(\"rect\", { width: 22, height: 18.65, fill: \"white\", transform: \"translate(1 2.70001)\" }))));\nexport default SvgOrderSuccess;\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { OrderDataModel } from '@/order/data/models';\nimport { transformCustomerAddressInput } from '@/order/data/transforms/transform-customer-address-input';\nimport { SignUpContext, UseOrderHeaderProps } from '@/order/types';\nimport { events } from '@adobe-commerce/event-bus';\nimport { useEffect, useState } from 'preact/hooks';\n\nexport const useOrderHeader = ({\n  orderData,\n  handleEmailAvailability,\n  handleSignUpClick,\n}: UseOrderHeaderProps) => {\n  const [order, setOrder] = useState(orderData);\n  const [isAuthenticated, setIsAuthenticated] = useState<boolean | undefined>();\n  const [isEmailAvailable, setIsEmailAvailable] = useState<boolean | undefined>(\n    handleEmailAvailability ? undefined : true\n  );\n\n  const customerEmail = order?.email;\n\n  const canCreateNewAccount =\n    handleSignUpClick &&\n    order !== undefined &&\n    isAuthenticated === false &&\n    isEmailAvailable === true;\n\n  const onSignUpClickHandler = canCreateNewAccount\n    ? () => {\n      const shippingAddress = order.shippingAddress;\n      const billingAddress = order.billingAddress;\n\n      const inputsDefaultValueSet: SignUpContext['inputsDefaultValueSet'] = [\n        { code: 'email', defaultValue: order.email },\n        { code: 'firstname', defaultValue: billingAddress?.firstName ?? '' },\n        { code: 'lastname', defaultValue: billingAddress?.lastName ?? '' },\n      ];\n\n      let addressesData: SignUpContext['addressesData'] = [];\n\n      if (shippingAddress) {\n        const customerShippingAddress = {\n          ...transformCustomerAddressInput(shippingAddress),\n          default_shipping: true,\n        };\n        const customerBillingAddress = {\n          ...transformCustomerAddressInput(billingAddress),\n          default_billing: true,\n        };\n        addressesData = [customerBillingAddress, customerShippingAddress];\n      } else {\n        const customerAddress = {\n          ...transformCustomerAddressInput(billingAddress),\n          default_billing: true,\n          default_shipping: true,\n        };\n        addressesData = [customerAddress];\n      }\n\n      handleSignUpClick({ inputsDefaultValueSet, addressesData });\n    }\n    : undefined;\n\n  useEffect(() => {\n    const event = events.on(\n      'authenticated',\n      (authenticated) => {\n        setIsAuthenticated(authenticated);\n      },\n      { eager: true }\n    );\n\n    return () => {\n      event?.off();\n    };\n  }, []);\n\n  useEffect(() => {\n    const event = events.on(\n      'order/data',\n      (order: OrderDataModel) => {\n        setOrder(order);\n      },\n      { eager: true }\n    );\n\n    return () => {\n      event?.off();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!handleEmailAvailability) return;\n    if (isAuthenticated === undefined) return;\n    if (isAuthenticated || !customerEmail) return;\n\n    handleEmailAvailability(customerEmail)\n      .then((result) => setIsEmailAvailable(result))\n      .catch(() => setIsEmailAvailable(true));\n  }, [isAuthenticated, handleEmailAvailability, customerEmail]);\n\n  return { order, onSignUpClickHandler };\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport {\n  OrderHeader as OrderHeaderComponent,\n  OrderHeaderSkeleton,\n} from '@/order/components';\nimport { useOrderHeader } from '@/order/hooks/containers/useOrderHeader';\nimport { OrderHeaderProps } from '@/order/types';\nimport { FunctionComponent } from 'preact';\n\nexport const OrderHeader: FunctionComponent<OrderHeaderProps> = (props) => {\n  const { order, onSignUpClickHandler } = useOrderHeader(props);\n\n  return (\n    <div>\n      {order ? (\n        <OrderHeaderComponent\n          customerName={order.billingAddress?.firstName}\n          onSignUpClick={onSignUpClickHandler}\n          orderNumber={order.number}\n        />\n      ) : (\n        <OrderHeaderSkeleton />\n      )}\n    </div>\n  );\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport '@/order/components/OrderHeader/OrderHeader.css';\nimport { Button, Header, Icon } from '@adobe-commerce/elsie/components';\nimport { Text, useText } from '@adobe-commerce/elsie/i18n';\nimport { OrderSuccess } from '@adobe-commerce/elsie/icons';\nimport { FunctionComponent } from 'preact';\n\nexport interface OrderHeaderProps {\n  customerName?: string;\n  onSignUpClick?: () => void;\n  orderNumber: string;\n}\n\nexport const OrderHeader: FunctionComponent<OrderHeaderProps> = ({\n  customerName,\n  orderNumber,\n  onSignUpClick,\n}) => {\n  const translations = useText({\n    title: (\n      <Text id=\"Order.OrderHeader.title\" fields={{ name: customerName }} />\n    ),\n    defaultTitle: 'Order.OrderHeader.defaultTitle',\n    order: (\n      <Text id=\"Order.OrderHeader.order\" fields={{ order: orderNumber }} />\n    ),\n    createAccountMessage: 'Order.OrderHeader.CreateAccount.message',\n    createAccountButton: 'Order.OrderHeader.CreateAccount.button',\n  });\n\n  return (\n    <div data-testid=\"order-header\" className=\"order-header order-header__card\">\n      <Icon source={OrderSuccess} size=\"64\" className=\"order-header__icon\" />\n\n      <Header\n        className=\"order-header__title\"\n        title={translations.title}\n        size=\"large\"\n        divider={false}\n      >\n        {customerName ? translations.title : translations.defaultTitle}\n      </Header>\n\n      <p className=\"order-header__order\">{translations.order}</p>\n\n      {onSignUpClick && (\n        <div className=\"order-header-create-account\">\n          <p className=\"order-header-create-account__message\">\n            {translations.createAccountMessage}\n          </p>\n\n          <Button\n            data-testid=\"create-account-button\"\n            className=\"order-header-create-account__button\"\n            size=\"medium\"\n            variant=\"secondary\"\n            type=\"submit\"\n            onClick={onSignUpClick}\n          >\n            {translations.createAccountButton}\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n};\n"],"names":["transformCustomerAddressInput","address","_a","attr","SvgOrderSuccess","props","React","useOrderHeader","orderData","handleEmailAvailability","handleSignUpClick","order","setOrder","useState","isAuthenticated","setIsAuthenticated","isEmailAvailable","setIsEmailAvailable","customerEmail","onSignUpClickHandler","shippingAddress","billingAddress","inputsDefaultValueSet","addressesData","customerShippingAddress","useEffect","event","events","authenticated","result","OrderHeader","jsx","OrderHeaderComponent","OrderHeaderSkeleton","customerName","orderNumber","onSignUpClick","translations","useText","Text","jsxs","Icon","OrderSuccess","Header","Button"],"mappings":"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","x_google_ignoreList":[1]}