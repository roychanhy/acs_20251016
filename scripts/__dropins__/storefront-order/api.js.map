{"version":3,"file":"api.js","sources":["/@dropins/storefront-order/src/data/transforms/transform-acdl.ts","/@dropins/storefront-order/src/data/transforms/transform-place-order.ts","/@dropins/storefront-order/src/lib/acdl.ts","/@dropins/storefront-order/src/lib/place-order-error.ts","/@dropins/storefront-order/src/api/graphql/PlaceOrderFragment.graphql.ts","/@dropins/storefront-order/src/api/placeOrder/graphql/placeOrderMutation.ts","/@dropins/storefront-order/src/lib/setReCaptchaToken.ts","/@dropins/storefront-order/src/api/placeOrder/placeOrder.ts","/@dropins/storefront-order/src/api/setPaymentMethodAndPlaceOrder/graphql/setPaymentMethodAndPlaceOrderMutation.ts","/@dropins/storefront-order/src/api/setPaymentMethodAndPlaceOrder/setPaymentMethodAndPlaceOrder.ts"],"sourcesContent":["/********************************************************************\n * ADOBE CONFIDENTIAL\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport {\n  OrderContext,\n  OrderDataModel,\n  ShoppingCartContext,\n} from '@/order/data/models';\n\nconst sumDiscounts = (accum: number, discount: any): number => {\n  return accum + discount.amount.value;\n};\n\nexport const transformShoppingCartContext = (\n  cartId: string,\n  data: OrderDataModel\n): ShoppingCartContext => {\n  return {\n    id: cartId,\n    totalQuantity: data.totalQuantity,\n    possibleOnepageCheckout: true,\n    // @ts-ignore\n    items: data.items.map((orderItem) => ({\n      // we don't know if the checkout drop-in can apply Manufacturerâ€™s Suggested Retail Price\n      canApplyMsrp: true,\n      formattedPrice: '',\n      id: orderItem.id,\n      quantity: orderItem.totalQuantity,\n      product: {\n        canonicalUrl: orderItem.product?.canonicalUrl,\n        mainImageUrl: orderItem.product?.image ?? '',\n        name: orderItem.product?.name ?? '',\n        productId: 0, // productId not exposed by core GraphQL as number (uid is string)\n        productType: orderItem.product?.productType,\n        sku: orderItem.product?.sku ?? '',\n        topLevelSku: orderItem.product?.sku,\n      },\n      prices: {\n        price: {\n          value: orderItem.price.value,\n          currency: orderItem.price.currency,\n          regularPrice: orderItem.regularPrice?.value ?? orderItem.price.value,\n        },\n      },\n      configurableOptions:\n        orderItem.selectedOptions?.map((selectedOption) => ({\n          optionLabel: selectedOption.label,\n          valueLabel: selectedOption.value,\n        })) || [],\n    })),\n    prices: {\n      subtotalExcludingTax: {\n        value: data.subtotalExclTax.value,\n        currency: data.subtotalExclTax.currency,\n      },\n      subtotalIncludingTax: {\n        value: data.subtotalInclTax.value,\n        currency: data.subtotalInclTax.currency,\n      },\n    },\n    discountAmount: data.discounts.reduce(sumDiscounts, 0),\n  };\n};\n\nexport const transformOrderContext = (data: OrderDataModel): OrderContext => {\n  const firstCoupon = data.coupons[0];\n  // for now, we only support one payment per order\n  const orderPayment = data.payments?.[0];\n\n  return {\n    appliedCouponCode: firstCoupon?.code ?? '',\n    email: data.email,\n    grandTotal: data.grandTotal.value,\n    orderId: data.number,\n    orderType: 'checkout',\n    otherTax: 0,\n    salesTax: data.totalTax.value,\n    shipping: {\n      shippingMethod: data.shipping?.code ?? '',\n      shippingAmount: data.shipping?.amount ?? 0,\n    },\n    subtotalExcludingTax: data.subtotalExclTax.value,\n    subtotalIncludingTax: data.subtotalInclTax.value,\n    payments: orderPayment\n      ? [\n          {\n            paymentMethodCode: orderPayment?.code || '',\n            paymentMethodName: orderPayment?.name || '',\n            total: data.grandTotal.value,\n            orderId: data.number,\n          },\n        ]\n      : [],\n    discountAmount: data.discounts.reduce(sumDiscounts, 0),\n    taxAmount: data.totalTax.value,\n  };\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { PlaceOrderResponse } from '@/order/types';\nimport { OrderDataModel } from '../models';\nimport { transformOrderData } from './transform-order-details';\n\nexport const transformPlaceOrder = (\n  response: PlaceOrderResponse\n): OrderDataModel | null => {\n  const orderData = response?.data?.placeOrder?.orderV2;\n  if (!orderData) return null;\n  return transformOrderData(orderData);\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { OrderDataModel } from '@/order/data/models';\nimport {\n  transformOrderContext,\n  transformShoppingCartContext,\n} from '@/order/data/transforms';\n\n/**\n * See: https://github.com/adobe/commerce-events/blob/main/packages/storefront-events-sdk/src/contexts.ts\n */\nexport const contexts = {\n  SHOPPING_CART_CONTEXT: 'shoppingCartContext',\n  ORDER_CONTEXT: 'orderContext',\n  CHANNEL_CONTEXT: 'channelContext',\n};\n\n/**\n * See: https://github.com/adobe/commerce-events/blob/main/packages/storefront-events-sdk/src/events.ts\n */\nexport const events = {\n  // See: https://github.com/adobe/commerce-events/blob/main/examples/events/place-order.md\n  PLACE_ORDER: 'place-order',\n};\n\nexport function getAdobeDataLayer() {\n  // @ts-ignore\n  window.adobeDataLayer = window.adobeDataLayer || [];\n  // @ts-ignore\n  return window.adobeDataLayer;\n}\n\n/**\n * Sets a context in the Adobe Client Data Layer (ACDL)\n * Logic based on: https://github.com/adobe/commerce-events/blob/main/packages/storefront-events-sdk/src/Base.ts#L6\n */\nfunction setContext(name: string, data: any) {\n  const adobeDataLayer = getAdobeDataLayer();\n\n  // Clear existing context\n  adobeDataLayer.push({\n    [name]: null,\n  });\n\n  // Set new context\n  adobeDataLayer.push({\n    [name]: data,\n  });\n}\n\n/**\n * Pushes an event to the Adobe Client Data Layer (ACDL)\n * Logic based on: https://github.com/adobe/commerce-events/blob/main/packages/storefront-events-sdk/src/Base.ts#L35\n */\nfunction pushEvent(event: string) {\n  const adobeDataLayer = getAdobeDataLayer();\n\n  adobeDataLayer.push((acdl: any) => {\n    const state = acdl.getState ? acdl.getState() : {};\n\n    acdl.push({\n      event,\n      eventInfo: {\n        ...state,\n      },\n    });\n  });\n}\n\nfunction getChannelContext() {\n  return {\n    _id: \"https://ns.adobe.com/xdm/channels/web\",\n    _type: \"https://ns.adobe.com/xdm/channel-types/web\",\n  };\n}\n\nexport function setChannelContext() {\n  setContext(contexts.CHANNEL_CONTEXT, getChannelContext());\n}\n\n// Triggered when an order is placed\nexport function publishPlaceOrderEvent(cartId: string, data: OrderDataModel) {\n  const orderContext = transformOrderContext(data);\n  const shoppingCartContext = transformShoppingCartContext(cartId, data);\n\n  // Set context and push open cart event\n  setContext(contexts.ORDER_CONTEXT, {\n    ...orderContext,\n  });\n\n  setContext(contexts.SHOPPING_CART_CONTEXT, {\n    ...shoppingCartContext,\n  });\n\n  setChannelContext();\n\n  pushEvent(events.PLACE_ORDER);\n}\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { PlaceOrderResponse } from '@/order/types';\n\nexport class PlaceOrderError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = 'PlaceOrderError';\n  }\n}\n\nexport const handlePlaceOrderError = (\n  errors: NonNullable<PlaceOrderResponse['errors']>\n) => {\n  const errorMessage = errors.map((e: any) => e.message).join(' ');\n  throw new PlaceOrderError(errorMessage);\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport {\n  ADDRESS_FRAGMENT,\n  BUNDLE_ORDER_ITEM_DETAILS_FRAGMENT,\n  GIFT_CARD_DETAILS_FRAGMENT,\n  ORDER_ITEM_DETAILS_FRAGMENT,\n  ORDER_SUMMARY_FRAGMENT,\n  PRICE_DETAILS_FRAGMENT,\n  PRODUCT_DETAILS_FRAGMENT,\n  ORDER_ITEM_FRAGMENT,\n  GIFT_WRAPPING_FRAGMENT,\n  GIFT_MESSAGE_FRAGMENT,\n  APPLIED_GIFT_CARDS_FRAGMENT,\n} from '@/order/api/fragments';\n\nexport const PLACE_ORDER_FRAGMENT = /* GraphQL */ `\n  fragment PLACE_ORDER_FRAGMENT on CustomerOrder {\n    printed_card_included\n    gift_receipt_included\n    gift_wrapping {\n      ...GIFT_WRAPPING_FRAGMENT\n    }\n    gift_message {\n      ...GIFT_MESSAGE_FRAGMENT\n    }\n    applied_gift_cards {\n      ...APPLIED_GIFT_CARDS_FRAGMENT\n    }\n    email\n    available_actions\n    status\n    number\n    token\n    id\n    order_date\n    carrier\n    shipping_method\n    is_virtual\n    applied_coupons {\n      code\n    }\n    shipments {\n      id\n      number\n      tracking {\n        title\n        number\n        carrier\n      }\n      comments {\n        message\n        timestamp\n      }\n      items {\n        id\n        product_sku\n        product_name\n        order_item {\n          ...ORDER_ITEM_DETAILS_FRAGMENT\n          ... on GiftCardOrderItem {\n            ...GIFT_CARD_DETAILS_FRAGMENT\n            product {\n              ...PRODUCT_DETAILS_FRAGMENT\n            }\n          }\n        }\n      }\n    }\n    payment_methods {\n      name\n      type\n    }\n    shipping_address {\n      ...ADDRESS_FRAGMENT\n    }\n    billing_address {\n      ...ADDRESS_FRAGMENT\n    }\n    items {\n      ...ORDER_ITEM_FRAGMENT\n    }\n    total {\n      ...ORDER_SUMMARY_FRAGMENT\n    }\n  }\n\n  ${ADDRESS_FRAGMENT}\n  ${BUNDLE_ORDER_ITEM_DETAILS_FRAGMENT}\n  ${GIFT_CARD_DETAILS_FRAGMENT}\n  ${ORDER_ITEM_DETAILS_FRAGMENT}\n  ${ORDER_SUMMARY_FRAGMENT}\n  ${PRICE_DETAILS_FRAGMENT}\n  ${PRODUCT_DETAILS_FRAGMENT}\n  ${ORDER_ITEM_FRAGMENT}\n  ${GIFT_WRAPPING_FRAGMENT}\n  ${GIFT_MESSAGE_FRAGMENT}\n  ${APPLIED_GIFT_CARDS_FRAGMENT}\n`;","/********************************************************************\n * ADOBE CONFIDENTIAL\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { PLACE_ORDER_FRAGMENT } from '@/order/api/graphql/PlaceOrderFragment.graphql';\n\nexport const PLACE_ORDER_MUTATION = /* GraphQL */ `\n  mutation PLACE_ORDER_MUTATION($cartId: String!) {\n    placeOrder(input: { cart_id: $cartId }) {\n      errors {\n        code\n        message\n      }\n      orderV2 {\n        ...PLACE_ORDER_FRAGMENT\n      }\n    }\n  }\n\n  ${PLACE_ORDER_FRAGMENT}\n`;\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { verifyReCaptcha } from '@adobe-commerce/recaptcha';\nimport { setFetchGraphQlHeader } from '../api';\n\nexport const setReCaptchaToken = async () => {\n  const token = await verifyReCaptcha();\n\n  if (token) {\n    setFetchGraphQlHeader('X-ReCaptcha', token);\n  }\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { fetchGraphQl } from '@/order/api';\nimport { OrderDataModel } from '@/order/data/models';\nimport { transformPlaceOrder } from '@/order/data/transforms';\nimport { publishPlaceOrderEvent } from '@/order/lib/acdl';\nimport { handleFetchError } from '@/order/lib/fetch-error';\nimport { handleNetworkError } from '@/order/lib/network-error';\nimport { handlePlaceOrderError } from '@/order/lib/place-order-error';\nimport { PlaceOrderResponse } from '@/order/types/index';\nimport { events } from '@adobe-commerce/event-bus';\nimport { PLACE_ORDER_MUTATION } from './graphql/placeOrderMutation';\nimport { setReCaptchaToken } from '@/order/lib/setReCaptchaToken';\n\nexport const placeOrder = async (\n  cartId: string\n): Promise<OrderDataModel | null | undefined> => {\n  if (!cartId) throw new Error('No cart ID found');\n  await setReCaptchaToken();\n\n  return fetchGraphQl(PLACE_ORDER_MUTATION, {\n    method: 'POST',\n    variables: { cartId },\n  })\n    .then((response: PlaceOrderResponse) => {\n      if (response.errors?.length) {\n        handleFetchError(response.errors);\n      }\n\n      if (response.data?.placeOrder?.errors?.length) {\n        handlePlaceOrderError(response.data.placeOrder?.errors);\n      }\n\n      const payload = transformPlaceOrder(response);\n\n      if (payload) {\n        events.emit('order/placed', payload);\n        events.emit('cart/reset', undefined);\n        publishPlaceOrderEvent(cartId, payload);\n      }\n\n      return payload;\n    })\n    .catch(handleNetworkError);\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { PLACE_ORDER_FRAGMENT } from '@/order/api/graphql/PlaceOrderFragment.graphql';\n\nexport const SET_PAYMENT_METHOD_AND_PLACE_ORDER_MUTATION = /* GraphQL */ `\n  mutation setPaymentMethodAndPlaceOrder($cartId: String!, $paymentMethod: PaymentMethodInput!) {\n    setPaymentMethodOnCart(\n      input: {\n        cart_id: $cartId\n        payment_method: $paymentMethod\n      }\n    ) {\n      cart {\n        selected_payment_method {\n          code\n          title\n        }\n      }\n    }\n    placeOrder(input: { cart_id: $cartId }) {\n      errors {\n        code\n        message\n      }\n      orderV2 {\n        ...PLACE_ORDER_FRAGMENT\n      }\n    }\n  }\n\n  ${PLACE_ORDER_FRAGMENT}\n`;","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2025 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { fetchGraphQl } from '@/order/api';\nimport { OrderDataModel } from '@/order/data/models';\nimport { transformPlaceOrder } from '@/order/data/transforms';\nimport { publishPlaceOrderEvent } from '@/order/lib/acdl';\nimport { handleFetchError } from '@/order/lib/fetch-error';\nimport { handleNetworkError } from '@/order/lib/network-error';\nimport { handlePlaceOrderError } from '@/order/lib/place-order-error';\nimport { events } from '@adobe-commerce/event-bus';\nimport { SET_PAYMENT_METHOD_AND_PLACE_ORDER_MUTATION } from './graphql/setPaymentMethodAndPlaceOrderMutation';\n\nexport const setPaymentMethodAndPlaceOrder = async (\n  cartId: string,\n  paymentMethod: any\n): Promise<OrderDataModel | null | undefined> => {\n  if (!cartId) throw new Error('No cart ID found');\n  if (!paymentMethod) throw new Error('No payment method found');\n\n  return fetchGraphQl(SET_PAYMENT_METHOD_AND_PLACE_ORDER_MUTATION, {\n    variables: { cartId, paymentMethod },\n  })\n    .then((response: any) => {\n      if (response.errors?.length) {\n        handleFetchError(response.errors);\n      }\n\n      // Check for errors in placeOrder part of the response\n      if (response.data?.placeOrder?.errors?.length) {\n        handlePlaceOrderError(response.data.placeOrder?.errors);\n      }\n\n      // Use the same transformation as placeOrder\n      const payload = transformPlaceOrder({ data: { placeOrder: response.data?.placeOrder } });\n\n      if (payload) {\n        events.emit('order/placed', payload);\n        events.emit('cart/reset', undefined);\n        publishPlaceOrderEvent(cartId, payload);\n      }\n\n      return payload;\n    })\n    .catch(handleNetworkError);\n};\n"],"names":["sumDiscounts","accum","discount","transformShoppingCartContext","cartId","data","orderItem","_a","_b","_c","_d","_e","_f","_g","_h","selectedOption","transformOrderContext","firstCoupon","orderPayment","transformPlaceOrder","response","orderData","transformOrderData","contexts","events","getAdobeDataLayer","setContext","name","adobeDataLayer","pushEvent","event","acdl","state","getChannelContext","setChannelContext","publishPlaceOrderEvent","orderContext","shoppingCartContext","PlaceOrderError","message","handlePlaceOrderError","errors","errorMessage","PLACE_ORDER_FRAGMENT","ADDRESS_FRAGMENT","BUNDLE_ORDER_ITEM_DETAILS_FRAGMENT","GIFT_CARD_DETAILS_FRAGMENT","ORDER_ITEM_DETAILS_FRAGMENT","ORDER_SUMMARY_FRAGMENT","PRICE_DETAILS_FRAGMENT","PRODUCT_DETAILS_FRAGMENT","ORDER_ITEM_FRAGMENT","GIFT_WRAPPING_FRAGMENT","GIFT_MESSAGE_FRAGMENT","APPLIED_GIFT_CARDS_FRAGMENT","PLACE_ORDER_MUTATION","setReCaptchaToken","token","verifyReCaptcha","setFetchGraphQlHeader","placeOrder","fetchGraphQl","handleFetchError","payload","handleNetworkError","SET_PAYMENT_METHOD_AND_PLACE_ORDER_MUTATION","setPaymentMethodAndPlaceOrder","paymentMethod"],"mappings":"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"}