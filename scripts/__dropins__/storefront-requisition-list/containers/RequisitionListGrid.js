/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsxs as c,jsx as i}from"@dropins/tools/preact-jsx-runtime.js";import*as f from"@dropins/tools/preact-compat.js";import{useState as p,useCallback as y,useEffect as O}from"@dropins/tools/preact-compat.js";import{Button as _,Card as B,Pagination as S,Icon as H,Modal as M,ProgressSpinner as U,Header as z}from"@dropins/tools/components.js";import{classes as r,VComponent as D,Slot as j}from"@dropins/tools/lib.js";import{g as I}from"../chunks/getRequisitionLists.js";import"@dropins/tools/preact-hooks.js";import{R as E}from"../chunks/RequisitionListForm.js";/* empty css                            */import{useText as h}from"@dropins/tools/i18n.js";import{d as G}from"../chunks/deleteRequisitionList.js";import"../chunks/transform-requisition-list.js";import"@dropins/tools/fetch-graphql.js";const V=({className:n,requisitionList:e,onEdit:a,onRemoveBtnClick:d,...m})=>{const s=h({actionRemove:"RequisitionList.RequisitionListItem.actionRemove",actionRename:"RequisitionList.RequisitionListItem.actionRename"}),t=()=>{a&&a(e.uid,{name:e.name,description:e.description||""})};return c("div",{...m,"data-testid":"requisition-list-item",className:r(["requisition-list-item__row",n]),children:[c("div",{className:r(["requisition-list-item__cell",n]),children:[i("strong",{className:"requisition-list-item__name",children:e.name}),i("div",{className:"requisition-list-item__description",children:e.description})]}),i("div",{className:r(["requisition-list-item__cell","requisition-list-item__items_count",n]),children:e.items_count}),i("div",{className:r(["requisition-list-item__cell","requisition-list-item__updated_at",n]),children:e.updated_at}),c("div",{className:r(["requisition-list-item__cell","requisition-list-item__actions",n]),children:[i(_,{type:"button",variant:"tertiary",onClick:t,"data-testid":"rename-button",children:s.actionRename}),i(_,{variant:"tertiary",type:"button","data-testid":"remove-button",onClick:()=>d(e,{isOpen:!0}),children:s.actionRemove})]})]})},F=({className:n,requisitionLists:e,header:a,addReqList:d=!1,...m})=>{var A,N,k;const s=h({name:"RequisitionList.RequisitionListWrapper.name",itemsCount:"RequisitionList.RequisitionListWrapper.itemsCount",lastUpdated:"RequisitionList.RequisitionListWrapper.lastUpdated",actions:"RequisitionList.RequisitionListWrapper.actions",loginMsg:"RequisitionList.RequisitionListWrapper.loginMsg",confirmRemove:"RequisitionList.RequisitionListWrapper.confirmRemove",confirmRemoveContent:"RequisitionList.RequisitionListWrapper.confirmRemoveContent",cancelAction:"RequisitionList.RequisitionListWrapper.cancelAction",confirmAction:"RequisitionList.RequisitionListWrapper.confirmAction"}),[t,l]=p(e),[u,q]=p({isOpen:!1,isLoading:!1}),[g,L]=p(),T=(o,R)=>{L(o),q({...R,isOpen:!0})},v=y(()=>{q({...u,isOpen:!1,isLoading:!1}),L(null)},[u,L,q]),W=y(async()=>{q({...u,isLoading:!0});const o=await G(g==null?void 0:g.uid);l({items:o.items,page_info:o.page_info}),v()},[g,l,u,v]),[P,w]=p(null),[x,C]=p(d),b=async(o=(R=>(R=t==null?void 0:t.page_info)==null?void 0:R.current_page)()??1)=>{l(await I(o))};return c("div",{...m,className:r(["requisition-list-grid-wrapper",n]),"data-testid":"requisition-list-grid-wrapper",children:[a&&i("div",{className:r(["requisition-list-grid-wrapper__header",n]),"data-testid":"requisition-list-grid-wrapper-header",children:i(D,{node:a})}),u.isOpen&&i(Q,{isOpen:u.isOpen,isLoading:u.isLoading,title:s.confirmRemove,modalContent:s.confirmRemoveContent,confirmBtnCaption:s.confirmAction,closeBtnCaption:s.cancelAction,handleModalOnClose:v,handleModalOnConfirm:W}),i("div",{className:r(["requisition-list-grid-wrapper__add-new",n]),children:x?i(B,{variant:"secondary",children:i(E,{mode:"create",onSuccess:async()=>{await b(),C(!1)},onCancel:()=>C(!1)})}):i(K,{onAddNew:()=>C(!0)})}),c("div",{className:r(["dropin-card dropin-card--secondary requisition-list-grid-wrapper__content",n]),children:[c("div",{className:r(["requisition-list-grid-wrapper__list-header",n]),children:[i("h5",{children:s.name}),i("h5",{children:s.itemsCount}),i("h5",{children:s.lastUpdated}),i("h5",{children:s.actions})]}),(A=t==null?void 0:t.items)==null?void 0:A.map(o=>P===o.uid?i(B,{variant:"secondary",className:"requisition-list-grid-wrapper__form-row",children:i(E,{mode:"edit",requisitionListUid:o.uid,defaultValues:{name:o.name,description:o.description},onSuccess:async()=>{await b(),w(null)},onCancel:()=>w(null)})},o.uid):i(V,{requisitionList:o,onEdit:R=>w(R),onRemoveBtnClick:T},o.uid)),i("div",{className:r(["requisition-list-grid-wrapper__pagination",n]),children:i(S,{totalPages:(N=t==null?void 0:t.page_info)==null?void 0:N.total_pages,currentPage:(k=t==null?void 0:t.page_info)==null?void 0:k.current_page,onChange:b})})]})]})},J=n=>f.createElement("svg",{id:"Icon_Add_Base","data-name":"Icon \\u2013 Add \\u2013 Base",xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...n},f.createElement("g",{id:"Large"},f.createElement("rect",{id:"Placement_area","data-name":"Placement area",width:24,height:24,fill:"#fff",opacity:0}),f.createElement("g",{id:"Add_icon","data-name":"Add icon",transform:"translate(9.734 9.737)"},f.createElement("line",{vectorEffect:"non-scaling-stroke",id:"Line_579","data-name":"Line 579",y2:12.7,transform:"translate(2.216 -4.087)",fill:"none",stroke:"currentColor"}),f.createElement("line",{vectorEffect:"non-scaling-stroke",id:"Line_580","data-name":"Line 580",x2:12.7,transform:"translate(-4.079 2.263)",fill:"none",stroke:"currentColor"})))),K=({selectable:n,className:e,onAddNew:a})=>{const d=h({addNewReqListBtn:"RequisitionList.AddNewReqList.addNewReqListBtn"});return c("button",{type:"button","aria-label":d.addNewReqListBtn,role:"button",className:r(["requisition-list-actions",["requisition-list-actions--selectable",n],e]),"data-testid":"requisition-list-actions-button",onClick:a,children:[i("span",{className:"requisition-list-actions__title","data-testid":"requisition-list-actions-button-text",children:d.addNewReqListBtn}),i(H,{source:J,size:"32"})]})},Q=({isOpen:n,isLoading:e,title:a,modalContent:d,closeBtnCaption:m,confirmBtnCaption:s,handleModalOnClose:t,handleModalOnConfirm:l})=>n?i(M,{className:"requisition-list-modal--overlay","data-testid":"requisition-list-modal",size:"medium",centered:!1,title:a,onClose:t,backgroundDim:!0,clickToDismiss:!0,escapeToDismiss:!0,children:c("div",{className:"requisition-list-modal",children:[e?i("div",{className:"requisition-list-modal__spinner","data-testid":"progress-spinner",children:i(U,{stroke:"4",size:"large"})}):null,i("p",{children:d}),c("div",{className:"requisition-list-modal__buttons",children:[t&&i(_,{"data-testid":"rl-modal-close-button",type:"button",onClick:t,variant:"secondary",disabled:e,children:m}),l&&i(_,{"data-testid":"rl-modal-confirm-button",type:"button",onClick:l,disabled:e,children:s})]})]})}):null,di=({requisitionLists:n,slots:e})=>{const[a,d]=p(n),[m,s]=p(!1),t=h({containerTitle:"RequisitionList.containerTitle"});O(()=>{if(a!==null)return;(async()=>{s(!0);const q=await I();d(q),s(!1)})()},[a]);const l=y(()=>e!=null&&e.Header?i(j,{name:"Header","aria-label":t.containerTitle,title:t.containerTitle,slot:e.Header}):i(z,{"aria-label":t.containerTitle,role:"region",title:t.containerTitle}),[e,t.containerTitle]);return i(F,{header:l(),requisitionLists:a,isLoading:m})};export{di as RequisitionListGrid,di as default};
//# sourceMappingURL=RequisitionListGrid.js.map
