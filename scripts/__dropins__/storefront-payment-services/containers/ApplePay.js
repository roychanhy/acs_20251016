/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as a}from"@dropins/tools/preact-jsx-runtime.js";import{u as D,S as P}from"../chunks/usePaymentsSDK.js";import{useRef as f,useEffect as R}from"@dropins/tools/preact-compat.js";import{useText as T}from"@dropins/tools/i18n.js";import"@dropins/tools/preact-hooks.js";const j=({apiUrl:g,getCartId:l,isVirtualCart:o,getCustomerToken:h,onStart:d,onSuccess:c,onError:m,onCancel:y,location:s,...u})=>{const r=s==="PRODUCT_DETAIL"||s==="CART"||s==="MINICART",A=r,n=f(),t=f(null),{methodNotAvailableMessage:S,methodNotLoadedMessage:M,loadingMessage:N}=T({methodNotAvailableMessage:"PaymentServices.ApplePay.messages.methodNotAvailable",methodNotLoadedMessage:"PaymentServices.ApplePay.messages.methodNotLoaded",loadingMessage:"PaymentServices.ApplePay.messages.loading"}),{paymentsSDK:e,sdkStatus:p}=D({apiUrl:g,getCustomerToken:h},s);return R(()=>{if(!(e!=null&&e.Payment.ApplePay.isAvailable())||!t.current)return;const v="apple-pay-"+Math.random().toString(36).slice(2,11);t.current.id=v;const b={container:`#${v}`,getCartId:l,onSuccess:c,onError:m,onCancel:y,onStart:d,isVirtualCart:o,useApplePayBillingAddress:A,useApplePayShippingAddress:r};return e.Payment.ApplePay.render(b).then(i=>{n.current=i}).catch(i=>{console.error("Apple Pay render failed:",i)}),()=>{n.current&&n.current.teardown()}},[e,p,l,d,c,m,y,o,r,A]),e&&!e.Payment.ApplePay.isAvailable()?a("div",{class:"payment-services_apple-pay-container",children:a("div",{class:"apple-pay-error",children:S})}):p===P.error?a("div",{class:"payment-services_apple-pay-container",children:a("div",{class:"apple-pay-error",children:M})}):p===P.loading?a("div",{class:"payment-services_apple-pay-container",...u,children:a("div",{class:"apple-pay-loading",children:N})}):a("div",{ref:t,class:"payment-services_apple-pay-container",...u})};export{j as ApplePay,j as default};
