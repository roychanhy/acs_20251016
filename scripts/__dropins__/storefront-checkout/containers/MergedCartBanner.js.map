{"version":3,"file":"MergedCartBanner.js","sources":["../../node_modules/@adobe-commerce/elsie/src/icons/InfoFilled.svg","/@dropins/storefront-checkout/src/containers/MergedCartBanner/MergedCartBanner.tsx"],"sourcesContent":["import * as React from \"react\";\nconst SvgInfoFilled = (props) => /* @__PURE__ */ React.createElement(\"svg\", { width: 24, height: 24, viewBox: \"0 0 24 24\", fill: \"none\", xmlns: \"http://www.w3.org/2000/svg\", ...props }, /* @__PURE__ */ React.createElement(\"path\", { fillRule: \"evenodd\", clipRule: \"evenodd\", d: \"M0 12C0 5.37931 5.37931 0 12 0C18.6207 0 24 5.37931 24 12C24 18.6207 18.6207 24 12 24C5.37931 24 0 18.6207 0 12ZM11.8885 5.06101C11.1405 5.06101 10.5357 5.66579 10.5357 6.4138V6.57295C10.5835 7.27321 11.1882 7.81433 11.8885 7.76658H12.0795C12.7797 7.70292 13.289 7.09815 13.2413 6.4138C13.2413 5.66579 12.6365 5.06101 11.8885 5.06101ZM13.1935 16.8223H14.1007C14.2599 16.8223 14.4031 16.9655 14.4031 17.1247V17.7294C14.4031 17.9045 14.2599 18.0318 14.1007 18.0318H9.8832C9.70813 18.0318 9.58081 17.8886 9.58081 17.7294V17.1247C9.58081 16.9496 9.72405 16.8223 9.8832 16.8223H10.7904V10.7905H9.8832C9.70813 10.7905 9.58081 10.6472 9.58081 10.4881V9.88329C9.58081 9.70823 9.72405 9.58091 9.8832 9.58091H12.5888C12.923 9.58091 13.1935 9.85146 13.1935 10.1857V16.8223Z\", fill: \"currentColor\" }));\nexport default SvgInfoFilled;\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport '@/checkout/containers/MergedCartBanner/MergedCartBanner.css';\nimport {\n  AlertBanner,\n  AlertBannerProps,\n  Icon,\n} from '@adobe-commerce/elsie/components';\nimport { Text, useText } from '@adobe-commerce/elsie/i18n';\nimport { InfoFilled } from '@adobe-commerce/elsie/icons';\nimport { classes } from '@adobe-commerce/elsie/lib/classes';\nimport { Container } from '@adobe-commerce/elsie/lib/types';\nimport { events } from '@adobe-commerce/event-bus';\nimport { useCallback, useEffect, useState } from 'preact/hooks';\n\nexport interface MergedCartBannerProps extends AlertBannerProps {\n  active?: boolean;\n}\n\nexport const MergedCartBanner: Container<MergedCartBannerProps> = ({\n  className,\n  initialData,\n  active = true,\n  ...props\n}) => {\n  const [totalMergedItems, setTotalMergedItems] = useState(0);\n\n  const translations = useText({\n    mergedCartBannerItems: (\n      <Text\n        fields={{\n          count: totalMergedItems,\n        }}\n        id=\"Checkout.MergedCartBanner.items\"\n        plural={totalMergedItems}\n      />\n    ),\n  });\n\n  const onDismiss = () => {\n    setTotalMergedItems(0);\n  };\n\n  const handleCartMerged = useCallback((data: { oldCartItems: any[] }) => {\n    const oldCartItems = data?.oldCartItems?.reduce(\n      (acc, item) => acc + item.quantity,\n      0\n    );\n\n    if (oldCartItems > 0) {\n      setTotalMergedItems(oldCartItems);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (!active) return;\n\n    const onCartMerged = events.on('cart/merged', handleCartMerged, {\n      eager: true,\n    });\n    return () => {\n      onCartMerged?.off();\n    };\n  }, [active, handleCartMerged]);\n\n  useEffect(() => {\n    if (!active) return;\n\n    const onCartReset = events.on(\n      'cart/reset',\n      () => {\n        setTotalMergedItems(0);\n      },\n      {\n        eager: false,\n      }\n    );\n    return () => {\n      onCartReset?.off();\n    };\n  }, [active]);\n\n  if (!active || !totalMergedItems) return null;\n\n  return (\n    <AlertBanner\n      {...props}\n      aria-label={translations.mergedCartBannerItems}\n      className={classes(['checkout__banner', className])}\n      data-testid=\"merged-cart-banner\"\n      icon={<Icon source={InfoFilled} />}\n      message={<span>{translations.mergedCartBannerItems}</span>}\n      variant=\"neutral\"\n      onDismiss={onDismiss}\n    />\n  );\n};\n"],"names":["SvgInfoFilled","props","React","MergedCartBanner","className","initialData","active","totalMergedItems","setTotalMergedItems","useState","translations","useText","jsx","Text","onDismiss","handleCartMerged","useCallback","data","oldCartItems","_a","acc","item","useEffect","onCartMerged","events","onCartReset","AlertBanner","classes","Icon","InfoFilled"],"mappings":"qaACA,MAAMA,EAAiBC,GAA0BC,EAAM,cAAc,MAAO,CAAE,MAAO,GAAI,OAAQ,GAAI,QAAS,YAAa,KAAM,OAAQ,MAAO,6BAA8B,GAAGD,CAAO,EAAkBC,EAAM,cAAc,OAAQ,CAAE,SAAU,UAAW,SAAU,UAAW,EAAG,6vBAA8vB,KAAM,cAAgB,CAAA,CAAC,ECiC7hCC,EAAqD,CAAC,CACjE,UAAAC,EACA,YAAAC,EACA,OAAAC,EAAS,GACT,GAAGL,CACL,IAAM,CACJ,KAAM,CAACM,EAAkBC,CAAmB,EAAIC,EAAS,CAAC,EAEpDC,EAAeC,EAAQ,CAC3B,sBACEC,EAACC,EAAA,CACC,OAAQ,CACN,MAAON,CACT,EACA,GAAG,kCACH,OAAQA,CAAA,CAAA,CACV,CAEH,EAEKO,EAAY,IAAM,CACtBN,EAAoB,CAAC,CACvB,EAEMO,EAAmBC,EAAaC,GAAkC,OAChE,MAAAC,GAAeC,EAAAF,GAAA,YAAAA,EAAM,eAAN,YAAAE,EAAoB,OACvC,CAACC,EAAKC,IAASD,EAAMC,EAAK,SAC1B,GAGEH,EAAe,GACjBV,EAAoBU,CAAY,CAEpC,EAAG,EAAE,EA8BL,OA5BAI,EAAU,IAAM,CACd,GAAI,CAAChB,EAAQ,OAEb,MAAMiB,EAAeC,EAAO,GAAG,cAAeT,EAAkB,CAC9D,MAAO,EAAA,CACR,EACD,MAAO,IAAM,CACXQ,GAAA,MAAAA,EAAc,KAChB,CAAA,EACC,CAACjB,EAAQS,CAAgB,CAAC,EAE7BO,EAAU,IAAM,CACd,GAAI,CAAChB,EAAQ,OAEb,MAAMmB,EAAcD,EAAO,GACzB,aACA,IAAM,CACJhB,EAAoB,CAAC,CACvB,EACA,CACE,MAAO,EAAA,CAEX,EACA,MAAO,IAAM,CACXiB,GAAA,MAAAA,EAAa,KACf,CAAA,EACC,CAACnB,CAAM,CAAC,EAEP,CAACA,GAAU,CAACC,EAAyB,KAGvCK,EAACc,EAAA,CACE,GAAGzB,EACJ,aAAYS,EAAa,sBACzB,UAAWiB,EAAQ,CAAC,mBAAoBvB,CAAS,CAAC,EAClD,cAAY,qBACZ,KAAMQ,EAACgB,EAAK,CAAA,OAAQC,CAAY,CAAA,EAChC,QAASjB,EAAC,OAAM,CAAA,SAAAF,EAAa,sBAAsB,EACnD,QAAQ,UACR,UAAAI,CAAA,CACF,CAEJ","x_google_ignoreList":[0]}