{"version":3,"file":"ServerError.js","sources":["/@dropins/storefront-checkout/src/components/ServerError/ServerError.tsx","/@dropins/storefront-checkout/src/containers/ServerError/ServerError.tsx"],"sourcesContent":["/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport '@/checkout/components/ServerError/ServerError.css';\nimport {\n  Button,\n  Icon,\n  IllustratedMessage,\n} from '@adobe-commerce/elsie/components';\nimport { useText } from '@adobe-commerce/elsie/i18n';\nimport { OrderError } from '@adobe-commerce/elsie/icons';\nimport { classes } from '@adobe-commerce/elsie/lib';\nimport { FunctionComponent, RefObject } from 'preact';\nimport { HTMLAttributes } from 'preact/compat';\n\nexport interface ServerErrorProps\n  extends Omit<HTMLAttributes<HTMLDivElement>, 'icon'> {\n  errorMessageRef?: RefObject<HTMLParagraphElement>;\n  errorMessage: string;\n  contactSupport?: string;\n  onClick?: (e: any) => void;\n}\n\nexport const ServerError: FunctionComponent<ServerErrorProps> = ({\n  className,\n  contactSupport,\n  errorMessage,\n  onClick,\n  errorMessageRef,\n}) => {\n  const translations = useText({\n    Title: 'Checkout.ServerError.title',\n    Message: 'Checkout.ServerError.message',\n    ContactSupport: 'Checkout.ServerError.contactSupport',\n    Button: 'Checkout.ServerError.button',\n  });\n\n  const heading = errorMessage !== '' ? errorMessage : translations.Title;\n\n  return (\n    <IllustratedMessage\n      action={\n        <Button\n          className={classes(['checkout-server-error__button'])}\n          name=\"server-error-button\"\n          onClick={onClick}\n        >\n          {translations.Button}\n        </Button>\n      }\n      aria-describedby=\"checkout-server-error__message\"\n      aria-invalid=\"true\"\n      aria-live=\"polite\"\n      className={classes(['checkout-server-error', className])}\n      data-testid=\"checkout-server-error\"\n      heading={heading}\n      icon={\n        <Icon\n          className={classes(['checkout-server-error__icon'])}\n          source={OrderError}\n        />\n      }\n      message={\n        <p\n          ref={errorMessageRef}\n          data-testid=\"checkout-server-error-message\"\n          id={classes(['checkout-server-error__message'])}\n        >\n          {translations.Message}\n          <br />\n          <span>{contactSupport ?? translations.ContactSupport}</span>\n        </p>\n      }\n    />\n  );\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { ServerError as ServerErrorComponent } from '@/checkout/components';\nimport { scrollToElement } from '@/checkout/lib';\nimport { serverErrorSignal } from '@/checkout/signals/ServerErrorSignal';\nimport { Container } from '@adobe-commerce/elsie/lib';\nimport { useEffect, useRef } from 'preact/hooks';\n\nexport interface ServerErrorProps {\n  autoScroll?: boolean;\n  onRetry?: () => void;\n  onServerError?: (error: string) => void;\n  active?: boolean;\n}\n\nexport const ServerError: Container<ServerErrorProps> = ({\n  active = true,\n  onRetry,\n  onServerError,\n  autoScroll = false,\n}) => {\n  const errorMessageRef = useRef<HTMLParagraphElement>(null);\n  const errorMessage = serverErrorSignal.value;\n\n  const handleClick = async () => {\n    onRetry?.();\n    serverErrorSignal.value = undefined;\n  };\n\n  useEffect(() => {\n    if (!errorMessage) return;\n    onServerError?.(errorMessage);\n  }, [errorMessage, onServerError]);\n\n  useEffect(() => {\n    if (!autoScroll || !errorMessage || !errorMessageRef.current) return;\n    scrollToElement(errorMessageRef.current);\n  }, [errorMessage, autoScroll]);\n\n  if (!active || !errorMessage) return null;\n\n  return (\n    <ServerErrorComponent\n      errorMessage={errorMessage}\n      errorMessageRef={errorMessageRef}\n      onClick={handleClick}\n    />\n  );\n};\n"],"names":["ServerError","className","contactSupport","errorMessage","onClick","errorMessageRef","translations","useText","heading","jsx","IllustratedMessage","Button","classes","Icon","OrderError","jsxs","active","onRetry","onServerError","autoScroll","useRef","serverErrorSignal","handleClick","useEffect","scrollToElement","ServerErrorComponent"],"mappings":"uzBAqCO,MAAMA,EAAmD,CAAC,CAC/D,UAAAC,EACA,eAAAC,EACA,aAAAC,EACA,QAAAC,EACA,gBAAAC,CACF,IAAM,CACJ,MAAMC,EAAeC,EAAQ,CAC3B,MAAO,6BACP,QAAS,+BACT,eAAgB,sCAChB,OAAQ,6BAAA,CACT,EAEKC,EAAUL,IAAiB,GAAKA,EAAeG,EAAa,MAGhE,OAAAG,EAACC,EAAA,CACC,OACED,EAACE,EAAA,CACC,UAAWC,EAAQ,CAAC,+BAA+B,CAAC,EACpD,KAAK,sBACL,QAAAR,EAEC,SAAaE,EAAA,MAAA,CAChB,EAEF,mBAAiB,iCACjB,eAAa,OACb,YAAU,SACV,UAAWM,EAAQ,CAAC,wBAAyBX,CAAS,CAAC,EACvD,cAAY,wBACZ,QAAAO,EACA,KACEC,EAACI,EAAA,CACC,UAAWD,EAAQ,CAAC,6BAA6B,CAAC,EAClD,OAAQE,CAAA,CACV,EAEF,QACEC,EAAC,IAAA,CACC,IAAKV,EACL,cAAY,gCACZ,GAAIO,EAAQ,CAAC,gCAAgC,CAAC,EAE7C,SAAA,CAAaN,EAAA,UACb,KAAG,EAAA,EACHG,EAAA,OAAA,CAAM,SAAkBP,GAAAI,EAAa,cAAe,CAAA,CAAA,CAAA,CAAA,CACvD,CAEJ,CAEJ,EC3DaN,EAA2C,CAAC,CACvD,OAAAgB,EAAS,GACT,QAAAC,EACA,cAAAC,EACA,WAAAC,EAAa,EACf,IAAM,CACE,MAAAd,EAAkBe,EAA6B,IAAI,EACnDjB,EAAekB,EAAkB,MAEjCC,EAAc,SAAY,CACpBL,GAAA,MAAAA,IACVI,EAAkB,MAAQ,MAC5B,EAYA,OAVAE,EAAU,IAAM,CACTpB,IACLe,GAAA,MAAAA,EAAgBf,GAAY,EAC3B,CAACA,EAAce,CAAa,CAAC,EAEhCK,EAAU,IAAM,CACV,CAACJ,GAAc,CAAChB,GAAgB,CAACE,EAAgB,SACrDmB,EAAgBnB,EAAgB,OAAO,CAAA,EACtC,CAACF,EAAcgB,CAAU,CAAC,EAEzB,CAACH,GAAU,CAACb,EAAqB,KAGnCM,EAACgB,EAAA,CACC,aAAAtB,EACA,gBAAAE,EACA,QAASiB,CAAA,CACX,CAEJ"}