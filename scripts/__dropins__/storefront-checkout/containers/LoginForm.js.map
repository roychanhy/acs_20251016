{"version":3,"file":"LoginForm.js","sources":["/@dropins/storefront-checkout/src/lib/validation.ts","/@dropins/storefront-checkout/src/components/LoginForm/Email.tsx","/@dropins/storefront-checkout/src/components/LoginForm/SignIn.tsx","/@dropins/storefront-checkout/src/components/LoginForm/LoginFormSkeleton.tsx","/@dropins/storefront-checkout/src/components/LoginForm/LoginForm.tsx","/@dropins/storefront-checkout/src/components/LoginForm/SignOut.tsx","/@dropins/storefront-checkout/src/containers/LoginForm/LoginForm.tsx"],"sourcesContent":["export const validationPatterns = {\n  EMAIL:\n    /^[a-z0-9,!#$%&'*+/=?^_`{|}~-]+(\\.[a-z0-9,!#$%&'*+/=?^_`{|}~-]+)*@([a-z0-9-]+\\.)+[a-z]{2,}$/i,\n};\n\nexport const validateEmail = (email: string): boolean => {\n  return validationPatterns.EMAIL.test(email);\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { Field, Input } from '@adobe-commerce/elsie/components';\nimport { useText } from '@adobe-commerce/elsie/i18n';\nimport { FunctionComponent } from 'preact';\nimport { HTMLAttributes } from 'preact/compat';\n\nexport interface LoginEmailProps extends HTMLAttributes<HTMLInputElement> {\n  value: string;\n  error: string;\n  hint: string;\n  onChange: (event: Event) => void;\n  onBlur: (event: Event) => void;\n  onInvalid: (event: Event) => void;\n}\n\nexport const Email: FunctionComponent<LoginEmailProps> = ({\n  value,\n  error,\n  hint,\n  onChange,\n  onBlur,\n  onInvalid,\n}) => {\n  const translations = useText({\n    LoginFormLabel: 'Checkout.LoginForm.ariaLabel',\n    LoginFormFloatingLabel: 'Checkout.LoginForm.floatingLabel',\n    LoginFormPlaceholder: 'Checkout.LoginForm.placeholder',\n  });\n\n  return (\n    <Field error={error} hint={hint}>\n      <Input\n        aria-label={translations.LoginFormLabel}\n        aria-required={true}\n        autocomplete=\"email\"\n        floatingLabel={translations.LoginFormFloatingLabel}\n        id=\"customer-email\"\n        name=\"customer-email\"\n        placeholder={translations.LoginFormPlaceholder}\n        required={true}\n        type=\"email\"\n        value={value}\n        onBlur={onBlur}\n        onChange={onChange}\n        onInvalid={onInvalid}\n      />\n    </Field>\n  );\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { useText } from '@adobe-commerce/elsie/i18n';\nimport { FunctionComponent } from 'preact';\n\ninterface SignInProps {\n  onClick: (event: Event) => void;\n}\n\nexport const SignIn: FunctionComponent<SignInProps> = ({ onClick }) => {\n  const translations = useText({\n    account: 'Checkout.LoginForm.account',\n    signIn: 'Checkout.LoginForm.signIn'\n  });\n\n  return (\n    <div className=\"checkout-login-form__sign-in\">\n      {translations.account}\n\n      <a\n        className=\"checkout-login-form__link\"\n        data-testid=\"sign-in-link\"\n        href=\"#\"\n        rel=\"noreferrer\"\n        target=\"_blank\"\n        onClick={(event) => {\n          event.preventDefault();\n          onClick(event);\n        }}\n      >\n        {translations.signIn}\n      </a>\n    </div>\n  );\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { Skeleton, SkeletonRow } from '@adobe-commerce/elsie/components';\nimport { FunctionComponent } from 'preact';\n\nexport const LoginFormSkeleton: FunctionComponent = () => {\n  return (\n    <Skeleton data-testid=\"login-form-skeleton\">\n      <SkeletonRow fullWidth={true} variant=\"heading\" />\n      <SkeletonRow fullWidth={true} size=\"medium\" />\n    </Skeleton>\n  );\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { Email } from '@/checkout/components';\nimport { WithConditionals } from '@/checkout/components/ConditionalWrapper/ConditionalWrapper';\nimport '@/checkout/components/LoginForm/LoginForm.css';\nimport { LoginFormSkeleton } from '@/checkout/components/LoginForm/LoginFormSkeleton';\nimport { Customer } from '@/checkout/data/models';\nimport { classes, VComponent } from '@adobe-commerce/elsie/lib';\nimport { FunctionComponent, VNode } from 'preact';\nimport { HTMLAttributes } from 'preact/compat';\n\nexport interface LoginFormProps\n  extends Omit<HTMLAttributes<HTMLFormElement>, 'title'> {\n  customer: Customer | null;\n  email: string;\n  error: string;\n  headingContent?: VNode;\n  hint: string | VNode;\n  onEmailBlur: (event: Event) => void;\n  onEmailChange: (event: Event) => void;\n  onEmailInvalid: (event: Event) => void;\n  title?: VNode;\n}\n\nconst LoginFormComponent: FunctionComponent<LoginFormProps> = ({\n  className,\n  customer,\n  email,\n  error,\n  headingContent,\n  hint,\n  name,\n  onEmailBlur,\n  onEmailChange,\n  onEmailInvalid,\n  title,\n  ...props\n}) => {\n  return (\n    <div className=\"checkout-login-form\" data-testid=\"checkout-login-form\">\n      <div className=\"checkout-login-form__heading\">\n        {title && (\n          <VComponent className=\"checkout-login-form__title\" node={title} />\n        )}\n\n        {headingContent && (\n          <VComponent\n            className=\"checkout-login-form__heading-label\"\n            node={headingContent}\n          />\n        )}\n      </div>\n\n      {customer ? (\n        <div className=\"checkout-login-form__customer-details\">\n          <div className=\"checkout-login-form__customer-name\">\n            {`${customer.firstName} ${customer.lastName}`}\n          </div>\n\n          <div className=\"checkout-login-form__customer-email\">\n            {customer.email}\n          </div>\n        </div>\n      ) : (\n        <div className=\"checkout-login-form__content\">\n          <form\n            {...props}\n            noValidate\n            className={classes(['dropin-login-form__form', className])}\n            name={name}\n          >\n            {/* Prevent 'Enter' key press from submitting this form. */}\n            <button\n              disabled\n              aria-hidden=\"true\"\n              style=\"display: none\"\n              type=\"submit\"\n            />\n            <Email\n              error={error}\n              hint={hint as any}\n              value={email}\n              onBlur={onEmailBlur}\n              onChange={onEmailChange}\n              onInvalid={onEmailInvalid}\n            />\n          </form>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport const LoginForm = WithConditionals(\n  LoginFormComponent,\n  LoginFormSkeleton\n);\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport { useText } from '@adobe-commerce/elsie/i18n';\nimport { FunctionComponent } from 'preact';\n\ninterface SignOutProps {\n  onClick: (event: Event) => void;\n}\n\nexport const SignOut: FunctionComponent<SignOutProps> = ({ onClick }) => {\n  const translations = useText({\n    switch: 'Checkout.LoginForm.switch',\n    signOut: 'Checkout.LoginForm.signOut'\n  });\n\n  return (\n    <p className=\"checkout-login-form__sign-out\">\n      {translations.switch}\n\n      <a\n        className=\"checkout-login-form__link\"\n        href=\"#\"\n        rel=\"noreferrer\"\n        target=\"_blank\"\n        onClick={(event) => {\n          event.preventDefault();\n          onClick?.(event);\n        }}\n      >\n        {translations.signOut}\n      </a>\n    </p>\n  );\n};\n","/********************************************************************\n * ADOBE CONFIDENTIAL\n * __________________\n *\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe and its suppliers, if any. The intellectual\n * and technical concepts contained herein are proprietary to Adobe\n * and its suppliers and are protected by all applicable intellectual\n * property laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe.\n *******************************************************************/\n\nimport {\n  getCustomer,\n  isEmailAvailable,\n  setGuestEmailOnCart,\n} from '@/checkout/api';\nimport {\n  LoginForm as LoginFormComponent,\n  SignIn,\n  SignOut,\n} from '@/checkout/components/LoginForm';\nimport { Cart, Customer } from '@/checkout/data/models';\nimport {\n  getCartEmail,\n  getLatestCheckoutUpdate,\n  getValue,\n  notifyValues,\n  validateEmail,\n} from '@/checkout/lib';\nimport { TitleProps } from '@/checkout/types/TitleProps';\nimport { useText } from '@adobe-commerce/elsie/i18n';\nimport { Container, Slot, SlotProps } from '@adobe-commerce/elsie/lib';\nimport { events } from '@adobe-commerce/event-bus';\nimport { HTMLAttributes } from 'preact/compat';\nimport {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'preact/hooks';\n\ninterface ValidationError {\n  email: string;\n  message: string;\n  type: 'missing' | 'invalid';\n}\n\ninterface CartSyncError {\n  email: string;\n  error: Error;\n}\n\nexport interface LoginFormProps\n  extends HTMLAttributes<HTMLFormElement>,\n    TitleProps {\n  active?: boolean;\n  autoSync?: boolean;\n  displayHeadingContent?: boolean;\n  onSignInClick?: (email: string) => void;\n  onSignOutClick?: () => void;\n  onCartSyncError?: (error: CartSyncError) => void;\n  onValidationError?: (error: ValidationError) => void;\n  slots?: {\n    Heading?: SlotProps<{\n      authenticated: boolean;\n    }>;\n  } & TitleProps['slots'];\n}\n\nconst DEBOUNCE_TIME = 1000;\n\nexport const LoginForm: Container<LoginFormProps> = ({\n  active = true,\n  autoSync = true,\n  displayHeadingContent = true,\n  displayTitle = true,\n  initialData,\n  onCartSyncError,\n  onSignInClick,\n  onSignOutClick,\n  onValidationError,\n  slots,\n  ...props\n}) => {\n  const [customer, setCustomer] = useState<Customer | null>(null);\n  const [email, setEmail] = useState<string>('');\n  const [error, setError] = useState<string>('');\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isAvailable, setIsAvailable] = useState<boolean>(true);\n  const [isInitialized, setIsInitialized] = useState<boolean>(false);\n\n  const debounceTimer = useRef<ReturnType<typeof setTimeout> | null>(null);\n\n  const {\n    alreadyHaveAccountHint,\n    cartSyncError,\n    defaultTitle,\n    fasterCheckoutHint,\n    invalidEmailError,\n    missingEmailError,\n    signInLabel,\n  } = useText({\n    alreadyHaveAccountHint: 'Checkout.LoginForm.emailExists.alreadyHaveAccount',\n    cartSyncError: 'Checkout.LoginForm.cartSyncError',\n    defaultTitle: 'Checkout.LoginForm.title',\n    fasterCheckoutHint: 'Checkout.LoginForm.emailExists.forFasterCheckout',\n    invalidEmailError: 'Checkout.LoginForm.invalidEmailError',\n    missingEmailError: 'Checkout.LoginForm.missingEmailError',\n    signInLabel: 'Checkout.LoginForm.emailExists.signInButton',\n  });\n\n  const setEmailAndCheckAvailability = useCallback(\n    (email: string) => {\n      if (!validateEmail(email) || email === getCartEmail()) return;\n\n      isEmailAvailable(email)\n        .then((availability) => {\n          setIsAvailable(availability);\n        })\n        .catch((error) => {\n          console.error(error);\n          setIsAvailable(true);\n        });\n\n      if (!autoSync) return;\n\n      setGuestEmailOnCart(email).catch((error) => {\n        onCartSyncError?.({ email, error });\n\n        if (!onCartSyncError) {\n          setError(cartSyncError);\n        }\n      });\n    },\n    [autoSync, onCartSyncError, cartSyncError]\n  );\n\n  const handleChange = useCallback(\n    (event: Event) => {\n      const target = event.target as HTMLInputElement;\n      const email = target.value;\n\n      setEmail(email);\n      setIsAvailable(true);\n      setError('');\n\n      if (debounceTimer.current) {\n        clearTimeout(debounceTimer.current);\n      }\n\n      debounceTimer.current = setTimeout(() => {\n        setEmailAndCheckAvailability(email);\n        notifyValues({ email });\n        debounceTimer.current = null;\n      }, DEBOUNCE_TIME);\n    },\n    [setEmailAndCheckAvailability]\n  );\n\n  const handleBlur = useCallback(\n    (event: Event) => {\n      const target = event.target as HTMLInputElement;\n      const email = target.value.trim();\n      const isValid = validateEmail(email);\n\n      if (isValid) {\n        setError('');\n        target.setCustomValidity('');\n\n        if (!debounceTimer.current) return;\n\n        clearTimeout(debounceTimer.current);\n        debounceTimer.current = null;\n        setEmailAndCheckAvailability(email);\n        notifyValues({ email });\n        return;\n      }\n\n      const type = email === '' ? 'missing' : 'invalid';\n      const message =\n        type === 'missing' ? missingEmailError : invalidEmailError;\n\n      if (onValidationError) {\n        onValidationError({ email, message, type });\n        return;\n      }\n\n      setError(message);\n      target.setCustomValidity(message);\n    },\n    [\n      invalidEmailError,\n      missingEmailError,\n      onValidationError,\n      setEmailAndCheckAvailability,\n    ]\n  );\n\n  const handleInvalid = useCallback(\n    (event: Event) => {\n      const target = event.target as HTMLInputElement;\n      const validity = target.validity;\n\n      const message = validity.valueMissing\n        ? missingEmailError\n        : invalidEmailError;\n\n      if (!onValidationError) {\n        setError(message);\n        return;\n      }\n\n      onValidationError({\n        email: target.value,\n        message,\n        type: validity.valueMissing ? 'missing' : 'invalid',\n      });\n    },\n    [missingEmailError, invalidEmailError, onValidationError]\n  );\n\n  const handleSignIn = useCallback(() => {\n    const email = getValue('email') ?? '';\n    const isValid = validateEmail(email);\n    onSignInClick?.(isValid ? email : '');\n  }, [onSignInClick]);\n\n  const handleSignOut = useCallback(() => {\n    onSignOutClick?.();\n  }, [onSignOutClick]);\n\n  const handleCheckoutData = useCallback((data: Cart | null) => {\n    const prevEmail = getValue('email') ?? '';\n    const email = data?.email ?? '';\n\n    if (email !== prevEmail) {\n      setEmail(email);\n      setError('');\n      setIsAvailable(true);\n      notifyValues({ email });\n    }\n  }, []);\n\n  useEffect(() => {\n    if (!active) return;\n\n    const onAuthenticated = events.on(\n      'authenticated',\n      (authenticated) => {\n        setIsAuthenticated(authenticated);\n\n        getCustomer()\n          .then((customer) => {\n            setCustomer(customer);\n          })\n          .catch(console.error);\n      },\n      { eager: true }\n    );\n\n    return () => {\n      onAuthenticated?.off();\n    };\n  }, [active]);\n\n  useEffect(() => {\n    if (!active) return;\n\n    const pastUpdate = getLatestCheckoutUpdate();\n\n    if (pastUpdate) {\n      setIsInitialized(true);\n      // When component becomes active, restore local state from checkout data\n      const checkoutEmail = pastUpdate.email ?? '';\n      if (checkoutEmail) {\n        setEmail(checkoutEmail);\n      }\n      handleCheckoutData(pastUpdate);\n      return;\n    }\n\n    const onCheckoutInit = events.on(\n      'checkout/initialized',\n      (data) => {\n        setIsInitialized(true);\n        handleCheckoutData(data);\n      },\n      { eager: true }\n    );\n\n    return () => {\n      onCheckoutInit?.off();\n    };\n  }, [active, handleCheckoutData]);\n\n  useEffect(() => {\n    if (!active) return;\n\n    const onCheckoutUpdated = events.on(\n      'checkout/updated',\n      handleCheckoutData,\n      { eager: false }\n    );\n\n    return () => {\n      onCheckoutUpdated?.off();\n    };\n  }, [active, handleCheckoutData]);\n\n  const titleContent = useMemo(() => {\n    if (!displayTitle) return undefined;\n\n    return (\n      <Slot name=\"checkout-login-form-title\" slot={slots?.Title}>\n        <h2>{defaultTitle}</h2>\n      </Slot>\n    );\n  }, [displayTitle, slots, defaultTitle]);\n\n  const headingContent = useMemo(() => {\n    if (!displayHeadingContent) return undefined;\n\n    return (\n      <Slot\n        context={{ authenticated: isAuthenticated }}\n        name=\"checkout-login-form-heading-label\"\n        slot={slots?.Heading}\n      >\n        {isAuthenticated ? (\n          <SignOut onClick={handleSignOut} />\n        ) : (\n          <SignIn onClick={handleSignIn} />\n        )}\n      </Slot>\n    );\n  }, [\n    displayHeadingContent,\n    isAuthenticated,\n    slots,\n    handleSignIn,\n    handleSignOut,\n  ]);\n\n  const hintContent = useMemo(() => {\n    if (isAvailable) return '';\n\n    return (\n      <>\n        {alreadyHaveAccountHint}{' '}\n        <a href=\"#\" onClick={handleSignIn}>\n          {signInLabel}\n        </a>{' '}\n        {fasterCheckoutHint}\n      </>\n    );\n  }, [\n    isAvailable,\n    alreadyHaveAccountHint,\n    signInLabel,\n    fasterCheckoutHint,\n    handleSignIn,\n  ]);\n\n  return (\n    <LoginFormComponent\n      {...props}\n      customer={customer}\n      email={email}\n      error={error}\n      headingContent={headingContent}\n      hint={hintContent}\n      initialized={isInitialized}\n      title={titleContent}\n      visible={active}\n      onEmailBlur={handleBlur}\n      onEmailChange={handleChange}\n      onEmailInvalid={handleInvalid}\n    />\n  );\n};\n"],"names":["validationPatterns","validateEmail","email","Email","value","error","hint","onChange","onBlur","onInvalid","translations","useText","jsx","Field","Input","SignIn","onClick","jsxs","event","LoginFormSkeleton","Skeleton","SkeletonRow","LoginFormComponent","className","customer","headingContent","name","onEmailBlur","onEmailChange","onEmailInvalid","title","props","VComponent","classes","LoginForm","WithConditionals","SignOut","DEBOUNCE_TIME","active","autoSync","displayHeadingContent","displayTitle","initialData","onCartSyncError","onSignInClick","onSignOutClick","onValidationError","slots","setCustomer","useState","setEmail","setError","isAuthenticated","setIsAuthenticated","isAvailable","setIsAvailable","isInitialized","setIsInitialized","debounceTimer","useRef","alreadyHaveAccountHint","cartSyncError","defaultTitle","fasterCheckoutHint","invalidEmailError","missingEmailError","signInLabel","setEmailAndCheckAvailability","useCallback","getCartEmail","isEmailAvailable","availability","setGuestEmailOnCart","handleChange","notifyValues","handleBlur","target","type","message","handleInvalid","validity","handleSignIn","getValue","isValid","handleSignOut","handleCheckoutData","data","prevEmail","useEffect","onAuthenticated","events","authenticated","getCustomer","pastUpdate","getLatestCheckoutUpdate","checkoutEmail","onCheckoutInit","onCheckoutUpdated","titleContent","useMemo","Slot","hintContent","Fragment"],"mappings":"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"}