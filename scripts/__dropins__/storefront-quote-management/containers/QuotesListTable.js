/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsxs as P,jsx as t}from"@dropins/tools/preact-jsx-runtime.js";import{useState as Q,useEffect as X}from"@dropins/tools/preact-compat.js";import{classes as Y,Slot as o}from"@dropins/tools/lib.js";import{Table as Z,IllustratedMessage as V,Picker as q,Pagination as ee,Button as te,Price as ae}from"@dropins/tools/components.js";import{events as ne}from"@dropins/tools/event-bus.js";/* empty css                                  */import{useText as ie}from"@dropins/tools/i18n.js";import{g as re}from"../chunks/NegotiableQuoteFragment.js";import"@dropins/tools/fetch-graphql.js";import{n as ce}from"../chunks/negotiableQuotes.js";const oe=({rowData:h=[],loading:S=!1,className:N,emptyStateMessage:y,showItemRange:v=!0,itemRangeMessage:m,showPageSizePicker:u=!0,pageSizePickerMessage:i,showPagination:x=!0,paginationMessage:l,...b})=>{const d=ie({quoteName:"QuoteManagement.QuotesListTable.quoteName",created:"QuoteManagement.QuotesListTable.created",createdBy:"QuoteManagement.QuotesListTable.createdBy",status:"QuoteManagement.QuotesListTable.status",lastUpdated:"QuoteManagement.QuotesListTable.lastUpdated",quoteTemplate:"QuoteManagement.QuotesListTable.quoteTemplate",quoteTotal:"QuoteManagement.QuotesListTable.quoteTotal",actions:"QuoteManagement.QuotesListTable.actions"}),s=[{key:"quoteName",label:d.quoteName},{key:"created",label:d.created},{key:"createdBy",label:d.createdBy},{key:"status",label:d.status},{key:"lastUpdated",label:d.lastUpdated},{key:"quoteTemplate",label:d.quoteTemplate},{key:"quoteTotal",label:d.quoteTotal},{key:"actions",label:d.actions}],z=!S&&h.length===0&&y,p=v&&m,f=u&&i,g=x&&l,T=p||f||g;return P("div",{...b,className:Y(["quote-management-quotes-list-table",N]),children:[t(Z,{columns:s,rowData:h,loading:S,mobileLayout:"none",className:"quote-management-quotes-list-table__table"}),z&&t("div",{className:"quotes-list-table__empty-state",children:y}),T&&P("div",{className:"quotes-list-table__footer",children:[t("div",{className:"quotes-list-table__item-range",children:p&&m}),t("div",{className:"quotes-list-table__pagination",children:g&&l}),t("div",{className:"quotes-list-table__page-size-picker",children:f&&i})]})]})},be=({pageSize:h,showItemRange:S=!0,showPageSizePicker:N=!0,showPagination:y=!0,onViewQuote:v,onPageSizeChange:m,onPageChange:u,slots:i,...x})=>{const[l,b]=Q(null),[d,s]=Q(!0),z=re()[0],[p,f]=Q(h||z),[g,T]=Q(1);X(()=>{const r=async()=>{try{s(!0);const c=await ce({pageSize:p,currentPage:g});b(c)}catch(c){console.error("Failed to fetch quotes:",c)}finally{s(!1)}},e=ne.on("authenticated",c=>{c?r():(b(null),s(!1))},{eager:!0});return()=>{e==null||e.off()}},[p,g]);const k=r=>{f(r),T(1),m==null||m(r)},_=r=>{T(r),u==null||u(r)},F=r=>{const e=r.target,c=e==null?void 0:e.value;c&&k(Number(c))},$=(r,e,c)=>r.filter(a=>a==null?void 0:a.uid).map(a=>{var I,w,B,M,A,U,C,O,R,D,E;const W=`${a.buyer.firstname} ${a.buyer.lastname}`;return{id:a.uid,quoteName:t(o,{name:"QuoteName",slot:e==null?void 0:e.QuoteName,context:{quote:a},children:t("span",{children:a.name})}),created:t(o,{name:"Created",slot:e==null?void 0:e.Created,context:{quote:a},children:t("span",{children:a.createdAt?new Date(a.createdAt).toLocaleDateString():"N/A"})}),createdBy:t(o,{name:"CreatedBy",slot:e==null?void 0:e.CreatedBy,context:{quote:a},children:t("span",{children:W})}),status:t(o,{name:"Status",slot:e==null?void 0:e.Status,context:{quote:a},children:t("span",{children:a.status})}),lastUpdated:t(o,{name:"LastUpdated",slot:e==null?void 0:e.LastUpdated,context:{quote:a},children:t("span",{children:a.updatedAt?new Date(a.updatedAt).toLocaleDateString():"N/A"})}),quoteTemplate:t(o,{name:"QuoteTemplate",slot:e==null?void 0:e.QuoteTemplate,context:{quote:a},children:t("span",{children:(B=(w=(I=a.items)==null?void 0:I[0])==null?void 0:w.product)==null?void 0:B.templateName})}),quoteTotal:t(o,{name:"QuoteTotal",slot:e==null?void 0:e.QuoteTotal,context:{quote:a},children:t(ae,{amount:(C=(U=(A=(M=a.items)==null?void 0:M[0])==null?void 0:A.prices)==null?void 0:U.grandTotal)==null?void 0:C.value,currency:(E=(D=(R=(O=a.items)==null?void 0:O[0])==null?void 0:R.prices)==null?void 0:D.grandTotal)==null?void 0:E.currency})}),actions:t(o,{name:"Actions",slot:e==null?void 0:e.Actions,context:{quote:a,onViewQuote:c},children:t(te,{variant:"tertiary",size:"medium",onClick:()=>c==null?void 0:c(a.uid,a.name,a.status),children:"View"})})}}),j=l!=null&&l.items?$(l.items,i,v):[],n=l==null?void 0:l.paginationInfo,L=!!n,G=t(o,{name:"EmptyQuotes",slot:i==null?void 0:i.EmptyQuotes,context:{quotesData:l},children:t(V,{heading:"No Quotes Found"})}),H=n?t(o,{name:"ItemRange",slot:i==null?void 0:i.ItemRange,context:n,children:P("span",{children:["Items ",n.startItem," to ",n.endItem," of"," ",n.totalCount," total"]})}):void 0,J=n&&n.pageSizeOptions?P(o,{name:"PageSizePicker",slot:i==null?void 0:i.PageSizePicker,context:{pageSize:n.pageSize,pageSizeOptions:n.pageSizeOptions,onPageSizeChange:k},children:[t("span",{children:"Show "}),t(q,{variant:"primary",size:"medium",value:String(n.pageSize),options:n.pageSizeOptions.map(r=>({value:String(r),text:String(r)})),handleSelect:F}),t("span",{children:" per page"})]}):void 0,K=n?t(o,{name:"Pagination",slot:i==null?void 0:i.Pagination,context:{currentPage:n.currentPage,totalPages:n.totalPages,onChange:_},children:t(ee,{currentPage:n.currentPage,totalPages:n.totalPages,onChange:_})}):void 0;return t(oe,{rowData:j,loading:d,className:x.className,emptyStateMessage:G,showItemRange:S&&L,itemRangeMessage:H,showPageSizePicker:N&&L,pageSizePickerMessage:J,showPagination:y&&L,paginationMessage:K})};export{be as QuotesListTable,be as default};
//# sourceMappingURL=QuotesListTable.js.map
