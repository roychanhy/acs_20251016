/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as a,Fragment as D,jsxs as j}from"@dropins/tools/preact-jsx-runtime.js";import{useRef as Xe,useState as x,useEffect as te,useCallback as U,useMemo as oe}from"@dropins/tools/preact-hooks.js";import{classes as K,Slot as he}from"@dropins/tools/lib.js";import{Field as le,Picker as Ye,Input as Qe,InputDate as De,Checkbox as He,TextArea as et,Card as Ae,Skeleton as Re,SkeletonRow as P,Button as de,Tag as ue,Icon as Ve,Modal as tt,ProgressSpinner as rt,IllustratedMessage as st,Header as nt,InLineAlert as at}from"@dropins/tools/components.js";import{m as ze,n as ke,u as be,d as Ue,i as dt,l as ot,k as lt,j as it,e as ct}from"./removeCustomerAddress.js";import{useText as se}from"@dropins/tools/i18n.js";import*as G from"@dropins/tools/preact-compat.js";import{memo as Me,forwardRef as ut,useImperativeHandle as pt,useId as ft,useMemo as Ce,useCallback as Te}from"@dropins/tools/preact-compat.js";import{Fragment as Ze}from"@dropins/tools/preact.js";import"@dropins/tools/event-bus.js";const pe=({hideActionFormButtons:e,formName:s,showFormLoader:n,showSaveCheckBox:r,saveCheckBoxValue:d,forwardFormRef:o,slots:i,addressesFormTitle:l,className:f,addressFormId:c,inputsDefaultValueSet:p,billingCheckBoxValue:L,shippingCheckBoxValue:O,showBillingCheckBox:v,showShippingCheckBox:C,isOpen:T,fieldIdPrefix:Z,onSubmit:t,onCloseBtnClick:m,onSuccess:A,onError:N,onChange:g})=>a("div",{className:K(["account-address-form"]),children:a(Yt,{hideActionFormButtons:e,formName:s,showFormLoader:n,slots:i,addressesFormTitle:l,className:f,addressFormId:c,inputsDefaultValueSet:p,shippingCheckBoxValue:O,billingCheckBoxValue:L,showShippingCheckBox:C,showBillingCheckBox:v,isOpen:T,fieldIdPrefix:Z,onSubmit:t,onCloseBtnClick:m,onSuccess:A,onError:N,onChange:g,forwardFormRef:o,showSaveCheckBox:r,saveCheckBoxValue:d})}),At=e=>e.reduce((s,n)=>({...s,[n.name]:n.value}),{}),ht=e=>/^\d+$/.test(e),mt=e=>/^[a-zA-Z0-9\s]+$/.test(e),Lt=e=>/^[a-zA-Z0-9]+$/.test(e),gt=e=>/^[a-zA-Z]+$/.test(e),bt=e=>/^[a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]+(\.[a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]+)*@([a-z0-9-]+\.)+[a-z]{2,}$/i.test(e),Ct=e=>/^\d{4}-\d{2}-\d{2}$/.test(e)&&!isNaN(Date.parse(e)),yt=(e,s,n)=>{const r=new Date(e).getTime()/1e3;return!(isNaN(r)||r<0||s!==void 0&&r<s||n!==void 0&&r>n)},Se=e=>!e||isNaN(Number(e))?"":new Date(parseInt(e,10)*1e3).toISOString().split("T")[0],vt=e=>/^(https?|ftp):\/\/(([A-Z0-9]([A-Z0-9_-]*[A-Z0-9]|))(\.[A-Z0-9]([A-Z0-9_-]*[A-Z0-9]|))*)(:(\d+))?(\/[A-Z0-9~](([A-Z0-9_~-]|\.)*[A-Z0-9~]|))*\/?(.*)?$/i.test(e),Mt=(e,s,n)=>{const r=e.length;return r>=s&&r<=n},ge=(e,s,n,r)=>{var h,B;const{requiredFieldError:d,lengthTextError:o,numericError:i,alphaNumWithSpacesError:l,alphaNumericError:f,alphaError:c,emailError:p,dateError:L,urlError:O,dateLengthError:v}=n,C=s==null?void 0:s.customUpperCode,T={[C]:""};if(r[C]&&delete r[C],s!=null&&s.required&&(!e||e==="false"))return{[C]:d};if(!(s!=null&&s.required)&&!e||!((h=s==null?void 0:s.validateRules)!=null&&h.length))return T;const Z=At(s==null?void 0:s.validateRules),t=Z.MIN_TEXT_LENGTH??1,m=Z.MAX_TEXT_LENGTH??255,A=Z.DATE_RANGE_MIN,N=Z.DATE_RANGE_MAX;if(!Mt(e,+t,+m)&&!(A||N))return{[C]:o.replace("{min}",t).replace("{max}",m)};if(!yt(e,+A,+N)&&(A||N))return{[C]:v.replace("{min}",Se(A)).replace("{max}",Se(N))};const w={numeric:{validate:ht,error:i},"alphanum-with-spaces":{validate:mt,error:l},alphanumeric:{validate:Lt,error:f},alpha:{validate:gt,error:c},email:{validate:bt,error:p},date:{validate:Ct,error:L},url:{validate:vt,error:O}}[Z.INPUT_VALIDATION];return w&&!w.validate(e)&&!((B=r[C])!=null&&B.length)?{[C]:w.error}:T},qe=e=>{switch(e){case"on":case"true":case 1:case"1":return!0;case"0":case"off":case"false":case 0:return!1;default:return!1}},$t=["true","false","yes","on","off"],_t={firstName:"",lastName:"",city:"",company:"",countryCode:"",region:"",regionCode:"",regionId:"",id:"",telephone:"",vatId:"",postcode:"",defaultShipping:"",defaultBilling:"",street:"",saveAddressBook:"",prefix:"",middleName:"",fax:"",suffix:"",uid:""},Et=e=>{const s={},n={};for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)){const d=e[r],o=r.match(/^(.*)Multiline_(\d+)$/);if(o){const i=o[1],l=parseInt(o[2],10);n[i]||(n[i]=[]),n[i].push({index:l,value:d})}else Object.keys(e).filter(l=>l.startsWith(`${r}Multiline_`)).length>0?n[r]=[{index:1,value:d}]:s[r]=d}for(const r in n)if(Object.prototype.hasOwnProperty.call(n,r)){const d=n[r];d.sort((o,i)=>o.index-i.index),s[r]=d.map(o=>o.value)}return s},Nt=e=>{const s={},n=[];for(const r in e){const d=$t.includes(e[r])?qe(e[r]):e[r];Object.prototype.hasOwnProperty.call(e,r)&&(Object.prototype.hasOwnProperty.call(_t,r)?s[r]=d:n.push({code:ke(r),value:d}))}return{...s,customAttributes:n}},ae=(e,s=!1)=>{const n=ze(e,"camelCase",{firstname:"firstName",lastname:"lastName",middlename:"middleName"}),r=Nt(Et(n));if(!s)return r;const[d,o]=r.region?r.region.split(","):[];return{...r,region:{regionCode:d,...o&&{regionId:+o}}}},fe=e=>{if(!e.current)return{};const s=e.current.elements;return Array.from(s).reduce((r,d)=>(d.name&&(r[d.name]=d.type==="checkbox"?d.checked:d.value),r),{})},Oe=(e,s)=>Object.keys(e).length?Object.keys(e).every(r=>r in s&&s[r]!==""):!1,je=e=>typeof e=="function",Tt=e=>e.reduce((s,{customUpperCode:n,required:r,defaultValue:d})=>(r&&n&&(s.initialData[n]=d||"",s.errorList[n]=""),s),{initialData:{},errorList:{}}),Fe=e=>Object.keys(e).length>0,Zt=({fieldsConfig:e,onSubmit:s,onChange:n,setInputChange:r,formName:d})=>{const o=se({requiredFieldError:"Account.FormText.requiredFieldError",lengthTextError:"Account.FormText.lengthTextError",numericError:"Account.FormText.numericError",alphaNumWithSpacesError:"Account.FormText.alphaNumWithSpacesError",alphaNumericError:"Account.FormText.alphaNumericError",alphaError:"Account.FormText.alphaError",emailError:"Account.FormText.emailError",dateError:"Account.FormText.dateError",dateLengthError:"Account.FormText.dateLengthError",urlError:"Account.FormText.urlError"}),i=Xe(null),[l,f]=x({}),[c,p]=x({}),[L,O]=x({}),[v,C]=x(!0),[T,Z]=x(!1),[t,m]=x(!1),[A,N]=x(!0),[g,w]=x(!1);te(()=>{const u=()=>{if(i.current){const M=window.getComputedStyle(i.current).getPropertyValue("grid-template-rows").split(" ").length,F=i.current.querySelector(".account-address-form--saveAddressBook");F&&(F.style.gridRow=String(M-1))}};return u(),window.addEventListener("resize",u),()=>{window.removeEventListener("resize",u)}},[e==null?void 0:e.length]);const h=U((u=!1)=>{let $=!0;const M={...c};let F=null;for(const[I,q]of Object.entries(l)){const _=e==null?void 0:e.find(S=>S.customUpperCode.includes(I)),b=ge(q.toString(),_,o,M);b[I]&&(Object.assign(M,b),$=!1),F||(F=Object.keys(M).find(S=>M[S])||null)}if(u||p(M),F&&i.current&&!u){const I=i.current.elements.namedItem(F);I==null||I.focus()}return $},[c,e,l,o]),B=U((u,$,M,F)=>{const I={...fe(i),[$]:u,...$.includes("countryCode")?{region:""}:{}},q={data:ae(I,!0),isDataValid:Oe(M,I)};w(q.isDataValid),h(!0),["selectedShippingAddress","selectedBillingAddress"].includes(d)&&sessionStorage.setItem(`${d}_addressData`,JSON.stringify(q)),n==null||n(q,{},F)},[h,d,n]);te(()=>{if(e!=null&&e.length){const{initialData:u,errorList:$}=Tt(e);f(M=>({...u,...M})),p($),O($)}},[JSON.stringify(e)]),te(()=>{if(t)return;const u=fe(i),$=sessionStorage.getItem(`${d}_addressData`);if(Fe(l)&&Fe(L)){let M={};const F=Oe(L,l);$?M=JSON.parse($).data:M=ae(u,!0)??{},n==null||n({data:M,isDataValid:F},{},null),w(F),m(!0)}},[l,L]),te(()=>{var I;if(!A)return;const u=fe(i),$=!!(u!=null&&u.countryCode),M=!!((I=u==null?void 0:u.region)!=null&&I.length);u&&$&&!M&&je(n)&&B(u==null?void 0:u.region,"region",L,null)},[A,v,e,i,n,B,L,T]);const z=U((u,$)=>{const{name:M,value:F,type:I,checked:q}=u==null?void 0:u.target,_=I==="checkbox"?q:F;f(H=>{const y={...H,[M]:_};return M==="countryCode"&&(y.region="",C(!0),Z(!1)),y}),r==null||r({[M]:_}),m(!0);const b=e==null?void 0:e.find(H=>H.customUpperCode.includes(M));let S=$?{...$}:{...c};if(b){const H=ge(_.toString(),b,o,S);H&&Object.assign(S,H),p(S)}B(_,M,L,u)},[r,e,c,o,B,L,v]),E=U(u=>{const{name:$}=u==null?void 0:u.target,M=e==null?void 0:e.find(F=>F.customUpperCode===$);$==="region"&&(M!=null&&M.options.length)&&N(!1),N($==="countryCode")},[]),k=U((u,$)=>{const{name:M,value:F,type:I,checked:q}=u==null?void 0:u.target,_=I==="checkbox"?q:F,b=e==null?void 0:e.find(S=>S.customUpperCode===M);if(b){const S=$?{...$}:{...c},H=ge(_.toString(),b,o,S);H&&Object.assign(S,H),p(S)}},[c,e,o]),W=U(u=>{u.preventDefault();const $=h();s==null||s(u,$)},[h,s]);return{isDataValid:g,formData:l,errors:c,formRef:i,handleInputChange:z,onFocus:E,handleBlur:k,handleSubmit:W,handleValidationSubmit:h}};var re=(e=>(e.BOOLEAN="BOOLEAN",e.DATE="DATE",e.DATETIME="DATETIME",e.DROPDOWN="DROPDOWN",e.FILE="FILE",e.GALLERY="GALLERY",e.HIDDEN="HIDDEN",e.IMAGE="IMAGE",e.MEDIA_IMAGE="MEDIA_IMAGE",e.MULTILINE="MULTILINE",e.MULTISELECT="MULTISELECT",e.PRICE="PRICE",e.SELECT="SELECT",e.TEXT="TEXT",e.TEXTAREA="TEXTAREA",e.UNDEFINED="UNDEFINED",e.VISUAL="VISUAL",e.WEIGHT="WEIGHT",e.EMPTY="",e))(re||{});const St=Me(({loading:e,values:s,fields:n=[],errors:r,className:d="",onChange:o,onBlur:i,onFocus:l,slots:f,fieldIdPrefix:c})=>{const p=`${d}__field`,L=(t,m)=>{if(!(f!=null&&f[`AddressFormInput_${t.code}`]))return;const A={inputName:t.customUpperCode,handleOnChange:o,handleOnBlur:i,handleOnFocus:l,errorMessage:m,errors:r,config:t};return a(he,{"data-testid":`addressFormInput_${t.code}`,name:`AddressFormInput_${t.code}`,slot:f[`AddressFormInput_${t.code}`],context:A},t.id)},O=(t,m,A)=>{var g;const N=((g=t.options.find(w=>w.isDefault))==null?void 0:g.value)??m??t.defaultValue;return a(D,{children:L(t,A)??a(le,{error:A,className:K([p,`${p}--${t.id}`,[`${p}--${t.id}-hidden`,t.isHidden],t.className]),"data-testid":`${d}--${t.id}`,disabled:e||t.disabled,children:a(Ye,{"aria-label":t.label,"aria-required":t.required?"true":"false",id:c?`${c}_${t.code}`:t.code,required:t==null?void 0:t.required,name:t.customUpperCode,floatingLabel:`${t.label} ${t.required?"*":""}`,placeholder:t.label,options:t.options,onBlur:i,onFocus:l,handleSelect:o,defaultValue:N,value:N})},t.id)})},v=(t,m,A)=>a(D,{children:L(t,A)??a(le,{error:A,className:K([p,`${p}--${t.id}`,[`${p}--${t.id}-hidden`,t.isHidden],t.className]),"data-testid":`${d}--${t.id}`,disabled:e,children:a(Qe,{"aria-label":t.label,"aria-required":t.required?"true":"false",id:c?`${c}_${t.code}`:t.code,type:"text",name:t.customUpperCode,value:m??t.defaultValue,placeholder:t.label,floatingLabel:`${t.label} ${t.required?"*":""}`,onBlur:i,onFocus:l,onChange:o})},t.id)}),C=(t,m,A)=>a(D,{children:L(t,A)??a(le,{error:A,className:K([p,`${p}--${t.id}`,[`${p}--${t.id}-hidden`,t.isHidden],t.className]),"data-testid":`${d}--${t.id}`,disabled:e||t.disabled,children:a(De,{"aria-label":t.label,"aria-required":t.required?"true":"false",id:c?`${c}_${t.code}`:t.code,type:"text",name:t.customUpperCode,value:m||t.defaultValue,placeholder:t.label,floatingLabel:`${t.label} ${t.required?"*":""}`,onBlur:i,onChange:o,disabled:e||t.disabled})},t.id)}),T=(t,m,A)=>a(D,{children:L(t,A)??a(le,{error:A,className:K([p,`${p}--${t.id}`,[`${p}--${t.id}-hidden`,t.isHidden],t.className]),"data-testid":`${d}--${t.id}`,disabled:(t==null?void 0:t.isHidden)??e,children:a(He,{"aria-label":t.label,"aria-required":t.required?"true":"false","aria-hidden":t.isHidden,tabindex:t!=null&&t.isHidden?-1:0,id:c?`${c}_${t.code}`:t.code,name:t.customUpperCode,checked:m||t.defaultValue,placeholder:t.label,label:`${t.label} ${t.required?"*":""}`,onBlur:i,onChange:o})},t.id)}),Z=(t,m,A)=>a(D,{children:L(t,A)??a(le,{error:A,className:K([p,`${p}--${t.id}`,[`${p}--${t.id}-hidden`,t.isHidden],t.className]),"data-testid":`${d}--${t.id}`,disabled:e,children:a(et,{"aria-label":t.label,"aria-required":t.required?"true":"false",id:c?`${c}_${t.code}`:t.code,type:"text",name:t.customUpperCode,value:m??t.defaultValue,label:`${t.label} ${t.required?"*":""}`,onBlur:i,onChange:o})},t.id)});return n.length?a(D,{children:n.map(t=>{const m=r==null?void 0:r[t.customUpperCode],A=s==null?void 0:s[t.customUpperCode];switch(t.fieldType){case re.TEXT:return t.options.length?O(t,A,m):v(t,A,m);case re.MULTILINE:return v(t,A,m);case re.SELECT:return O(t,A,m);case re.DATE:return C(t,A,m);case re.BOOLEAN:return T(t,A,m);case re.TEXTAREA:return Z(t,A,m);default:return null}})}):null}),We=({testId:e,withCard:s=!0})=>{const n=j(Re,{"data-testid":e||"skeletonLoader",children:[a(P,{variant:"heading",size:"xlarge",fullWidth:!1,lines:1}),a(P,{variant:"heading",size:"xlarge",fullWidth:!0,lines:1}),a(P,{variant:"heading",size:"xlarge",fullWidth:!0,lines:1})]});return s?n:a(Ae,{variant:"secondary",className:K(["account-account-loaders","account-account-loaders--card-loader"]),children:n})},Ot=()=>j(Re,{"data-testid":"addressFormLoader",children:[a(P,{variant:"heading",size:"medium"}),a(P,{variant:"empty",size:"medium"}),a(P,{size:"large"}),a(P,{size:"large"}),a(P,{size:"large",fullWidth:!0}),a(P,{size:"large",fullWidth:!0,lines:3}),a(P,{size:"large"}),a(P,{size:"large"}),a(P,{size:"large"}),a(P,{size:"large"}),a(P,{size:"large"}),a(P,{size:"large"}),a(P,{size:"large",fullWidth:!0})]}),Ft=Me(ut(({setInputChange:e,showFormLoader:s,slots:n,name:r,loading:d,children:o,className:i="defaultForm",fieldsConfig:l,onSubmit:f,onChange:c,forwardFormRef:p,regionOptions:L,showSaveCheckBox:O,handleSaveCheckBoxAddress:v,saveCheckBoxAddress:C,fieldIdPrefix:T})=>{const Z=se({saveAddressBook:"Account.AddressForm.formText.saveAddressBook"}),{isDataValid:t,formData:m,errors:A,formRef:N,handleInputChange:g,handleBlur:w,handleSubmit:h,handleValidationSubmit:B,onFocus:z}=Zt({fieldsConfig:l,onSubmit:f,onChange:c,setInputChange:e,regionOptions:L,formName:r});return pt(p,()=>{const E=fe(N);return{handleValidationSubmit:B,requestSubmit:()=>{var k;(k=N.current)==null||k.requestSubmit()},formData:ae(E,!0),isDataValid:t}}),s||!(l!=null&&l.length)?a(Ot,{}):j("form",{className:K(["account-form",i]),onSubmit:h,name:r,ref:N,children:[a(St,{className:i,loading:d,fields:l,onChange:g,onBlur:w,errors:A,values:m,onFocus:z,slots:n,fieldIdPrefix:T}),n!=null&&n.AddressFormInputs?a(he,{"data-testid":"addressFormInputs",name:"AddressFormInputs",slot:n.AddressFormInputs,context:{formActions:{handleChange:g}}}):null,O?a("div",{className:"account-address-form--saveAddressBook",children:a(He,{"data-testid":"testSaveAddressBook",name:"saveAddressBook",label:Z.saveAddressBook,checked:C,onChange:E=>{g(E),v==null||v(E)}})}):null,o]})})),Ie=(e,s,n={},r="editButton")=>{const d=r==="removeButton",o={shippingAndBilling:{edit:n.editAddressAriaLabelShippingAndBilling,remove:n.removeAddressAriaLabelShippingAndBilling},shipping:{edit:n.editAddressAriaLabelShipping,remove:n.removeAddressAriaLabelShipping},billing:{edit:n.editAddressAriaLabelBilling,remove:n.removeAddressAriaLabelBilling},default:{edit:n.editAddressAriaLabelDefault,remove:n.removeAddressAriaLabelDefault}};let i="default";return e&&s?i="shippingAndBilling":e?i="shipping":s&&(i="billing"),d?o[i].remove:o[i].edit},ye=({slots:e,selectable:s,selectShipping:n,selectBilling:r,variant:d="secondary",minifiedView:o,keysSortOrder:i,addressData:l,loading:f,setAddressId:c,handleRenderModal:p,handleRenderForm:L})=>{const O=ft(),v=o?"minifiedView":"fullSizeView",C=se({actionRemove:`Account.${v}.Addresses.addressCard.actionRemove`,actionEdit:`Account.${v}.Addresses.addressCard.actionEdit`,cardLabelShipping:`Account.${v}.Addresses.addressCard.cardLabelShipping`,cardLabelBilling:`Account.${v}.Addresses.addressCard.cardLabelBilling`,defaultLabelText:`Account.${v}.Addresses.addressCard.defaultLabelText`,editAddressAriaLabelDefault:`Account.${v}.Addresses.addressCard.ariaLabel.editButton.default`,editAddressAriaLabelShipping:`Account.${v}.Addresses.addressCard.ariaLabel.editButton.shipping`,editAddressAriaLabelBilling:`Account.${v}.Addresses.addressCard.ariaLabel.editButton.billing`,editAddressAriaLabelShippingAndBilling:`Account.${v}.Addresses.addressCard.ariaLabel.editButton.shippingAndBilling`,removeAddressAriaLabelDefault:`Account.${v}.Addresses.addressCard.ariaLabel.removeButton.default`,removeAddressAriaLabelShipping:`Account.${v}.Addresses.addressCard.ariaLabel.removeButton.shipping`,removeAddressAriaLabelBilling:`Account.${v}.Addresses.addressCard.ariaLabel.removeButton.billing`,removeAddressAriaLabelShippingAndBilling:`Account.${v}.Addresses.addressCard.ariaLabel.removeButton.shippingAndBilling`}),T=C.cardLabelBilling.toLocaleUpperCase(),Z=C.cardLabelShipping.toLocaleUpperCase(),t=C.defaultLabelText.toLocaleUpperCase(),m=Ce(()=>{const E={shippingLabel:Z,billingLabel:T,hideShipping:!1,hideBilling:!1};return s?n&&!r?{shippingLabel:t,billingLabel:t,hideShipping:!1,hideBilling:!0}:r&&!n?{shippingLabel:t,billingLabel:t,hideShipping:!0,hideBilling:!1}:E:E},[T,t,Z,r,n,s]),A=Te(()=>{c==null||c(l==null?void 0:l.id),p==null||p()},[p,l==null?void 0:l.id,c]),N=Te(()=>{c==null||c(l==null?void 0:l.id),L==null||L()},[L,l==null?void 0:l.id,c]),g=Ce(()=>{if(!i)return[];const{region:E,...k}=l,W={...k,...E};return i.filter(({name:u})=>W[u]).map(u=>({name:u.name,orderNumber:u.orderNumber,value:W[u.name],label:u.label}))},[l,i]),{shippingLabel:w,billingLabel:h,hideShipping:B,hideBilling:z}=m;return a(Ae,{variant:d,className:"account-address-card","data-testid":"addressCard",children:f?a(We,{}):j(D,{children:[j("div",{className:"account-address-card__action",children:[p?a(de,{type:"button",variant:"tertiary",onClick:A,"data-testid":"removeButton","aria-label":Ie(l==null?void 0:l.defaultShipping,l==null?void 0:l.defaultBilling,C,"removeButton"),"aria-describedby":O,children:C.actionRemove}):null,L?a(de,{type:"button",variant:"tertiary",onClick:N,className:"account-address-card__action--editbutton","data-testid":"editButton","aria-label":Ie(l==null?void 0:l.defaultShipping,l==null?void 0:l.defaultBilling,C,"editButton"),"aria-describedby":O,children:C.actionEdit}):null]}),a("div",{className:"account-address-card__description",id:O,children:e!=null&&e.AddressCard?a(he,{name:"AddressCard",slot:e==null?void 0:e.AddressCard,context:{addressData:g}}):a(D,{children:g.map((E,k)=>{const W=E.label?`${E.label}: ${E==null?void 0:E.value}`:E==null?void 0:E.value;return a("p",{"data-testid":`${E.name}_${k}`,children:W},k)})})}),(l!=null&&l.defaultShipping||l!=null&&l.defaultBilling)&&!s?j("div",{className:"account-address-card__labels",children:[l!=null&&l.defaultShipping?a(ue,{label:Z}):null,l!=null&&l.defaultBilling?a(ue,{label:T}):null]}):null,s?j("div",{className:"account-address-card__labels",children:[!B&&(l!=null&&l.defaultShipping)?a(ue,{label:w}):null,!z&&(l!=null&&l.defaultBilling)?a(ue,{label:h}):null]}):null]})})},It=e=>G.createElement("svg",{id:"Icon_Add_Base","data-name":"Icon \\u2013 Add \\u2013 Base",xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...e},G.createElement("g",{id:"Large"},G.createElement("rect",{id:"Placement_area","data-name":"Placement area",width:24,height:24,fill:"#fff",opacity:0}),G.createElement("g",{id:"Add_icon","data-name":"Add icon",transform:"translate(9.734 9.737)"},G.createElement("line",{vectorEffect:"non-scaling-stroke",id:"Line_579","data-name":"Line 579",y2:12.7,transform:"translate(2.216 -4.087)",fill:"none",stroke:"currentColor"}),G.createElement("line",{vectorEffect:"non-scaling-stroke",id:"Line_580","data-name":"Line 580",x2:12.7,transform:"translate(-4.079 2.263)",fill:"none",stroke:"currentColor"})))),xt=e=>G.createElement("svg",{id:"Icon_Chevron_right_Base","data-name":"Icon \\u2013 Chevron right \\u2013 Base",xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...e},G.createElement("g",{id:"Large"},G.createElement("rect",{id:"Placement_area","data-name":"Placement area",width:24,height:24,fill:"#fff",opacity:0}),G.createElement("g",{id:"Chevron_right_icon","data-name":"Chevron right icon"},G.createElement("path",{vectorEffect:"non-scaling-stroke",id:"chevron",d:"M199.75,367.5l4.255,-4.255-4.255,-4.255",transform:"translate(-189.25 -351.0)",fill:"none",stroke:"currentColor"})))),Bt=e=>G.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},G.createElement("path",{d:"M3.375 7.38672C3.09886 7.38672 2.875 7.61058 2.875 7.88672C2.875 8.16286 3.09886 8.38672 3.375 8.38672V7.38672ZM5.88409 8.38672C6.16023 8.38672 6.38409 8.16286 6.38409 7.88672C6.38409 7.61058 6.16023 7.38672 5.88409 7.38672V8.38672ZM3.375 11.1836C3.09886 11.1836 2.875 11.4075 2.875 11.6836C2.875 11.9597 3.09886 12.1836 3.375 12.1836V11.1836ZM5.88409 12.1836C6.16023 12.1836 6.38409 11.9597 6.38409 11.6836C6.38409 11.4075 6.16023 11.1836 5.88409 11.1836V12.1836ZM3.375 15.6133C3.09886 15.6133 2.875 15.8371 2.875 16.1133C2.875 16.3894 3.09886 16.6133 3.375 16.6133V15.6133ZM5.88409 16.6133C6.16023 16.6133 6.38409 16.3894 6.38409 16.1133C6.38409 15.8371 6.16023 15.6133 5.88409 15.6133V16.6133ZM8.52059 16.4182C8.51422 16.6942 8.73286 16.9232 9.00893 16.9296C9.285 16.9359 9.51396 16.7173 9.52032 16.4412L8.52059 16.4182ZM9.19302 14.8261L8.70612 14.7124C8.70434 14.72 8.70274 14.7277 8.70132 14.7354L9.19302 14.8261ZM11.2762 13.3887L11.4404 13.8611L11.4499 13.8576L11.2762 13.3887ZM12.3195 13.1013C12.4035 12.8382 12.2583 12.5569 11.9953 12.4729C11.7322 12.3889 11.4509 12.5341 11.3669 12.7971L12.3195 13.1013ZM15.7342 16.4412C15.7406 16.7173 15.9695 16.9359 16.2456 16.9296C16.5217 16.9232 16.7403 16.6942 16.734 16.4182L15.7342 16.4412ZM16.0615 14.8261L16.5532 14.7354C16.5518 14.7277 16.5502 14.72 16.5484 14.7124L16.0615 14.8261ZM13.9784 13.3887L13.8046 13.8577L13.8142 13.861L13.9784 13.3887ZM13.8877 12.7971C13.8037 12.5341 13.5223 12.3889 13.2593 12.4729C12.9962 12.5569 12.8511 12.8382 12.9351 13.1013L13.8877 12.7971ZM10.9023 10.418L11.4023 10.418V10.418H10.9023ZM11.2309 8.60993L11.6861 8.81678L11.6861 8.81678L11.2309 8.60993ZM12.0518 12.7684L11.7218 13.1441L11.7682 13.1848L11.823 13.213L12.0518 12.7684ZM13.202 12.7684L13.4308 13.213L13.4787 13.1884L13.5203 13.1541L13.202 12.7684ZM3.375 8.38672H5.88409V7.38672H3.375V8.38672ZM3.375 12.1836H5.88409V11.1836H3.375V12.1836ZM3.375 16.6133H5.88409V15.6133H3.375V16.6133ZM6.41058 2.375H18.844V1.375H6.41058V2.375ZM18.844 2.375C19.4866 2.375 20.125 2.99614 20.125 3.9225H21.125C21.125 2.57636 20.1627 1.375 18.844 1.375V2.375ZM20.125 3.9225V20.0775H21.125V3.9225H20.125ZM20.125 20.0775C20.125 20.9945 19.485 21.625 18.844 21.625V22.625C20.1643 22.625 21.125 21.4105 21.125 20.0775H20.125ZM18.844 21.625H6.41058V22.625H18.844V21.625ZM6.41058 21.625C5.76792 21.625 5.12955 21.0039 5.12955 20.0775H4.12955C4.12955 21.4236 5.09185 22.625 6.41058 22.625V21.625ZM5.12955 20.0775V3.9225H4.12955V20.0775H5.12955ZM5.12955 3.9225C5.12955 3.0055 5.76956 2.375 6.41058 2.375V1.375C5.0902 1.375 4.12955 2.5895 4.12955 3.9225H5.12955ZM9.52032 16.4412C9.53194 15.9373 9.59014 15.4295 9.68473 14.9168L8.70132 14.7354C8.59869 15.2917 8.53362 15.853 8.52059 16.4182L9.52032 16.4412ZM9.67993 14.9397C9.69157 14.8899 9.78099 14.7261 10.1128 14.496C10.4223 14.2813 10.8711 14.0589 11.4404 13.861L11.112 12.9165C10.4856 13.1343 9.94827 13.3931 9.54284 13.6743C9.15974 13.94 8.80542 14.2871 8.70612 14.7124L9.67993 14.9397ZM11.4499 13.8576C11.5852 13.8074 11.7547 13.7102 11.8933 13.6105C11.9656 13.5584 12.0441 13.4954 12.1133 13.4247C12.1723 13.3646 12.2709 13.2534 12.3195 13.1013L11.3669 12.7971C11.3809 12.7532 11.3985 12.7277 11.4022 12.7225C11.407 12.7157 11.4073 12.7164 11.3993 12.7246C11.3827 12.7416 11.3525 12.7676 11.3092 12.7988C11.2674 12.8288 11.222 12.8575 11.1805 12.8808C11.1363 12.9057 11.1089 12.9175 11.1024 12.9199L11.4499 13.8576ZM16.734 16.4182C16.7209 15.853 16.6559 15.2917 16.5532 14.7354L15.5698 14.9168C15.6644 15.4295 15.7226 15.9373 15.7342 16.4412L16.734 16.4182ZM16.5484 14.7124C16.4491 14.2871 16.0948 13.94 15.7117 13.6743C15.3063 13.3931 14.769 13.1343 14.1426 12.9165L13.8142 13.861C14.3834 14.0589 14.8322 14.2813 15.1417 14.496C15.4736 14.7261 15.563 14.8899 15.5746 14.9397L16.5484 14.7124ZM14.1521 12.9199C14.1456 12.9175 14.1183 12.9057 14.074 12.8808C14.0325 12.8575 13.9871 12.8288 13.9453 12.7988C13.9021 12.7676 13.8719 12.7416 13.8552 12.7246C13.8472 12.7164 13.8476 12.7157 13.8524 12.7225C13.856 12.7277 13.8736 12.7532 13.8877 12.7971L12.9351 13.1013C12.9836 13.2534 13.0823 13.3646 13.1412 13.4247C13.2105 13.4954 13.2889 13.5584 13.3612 13.6105C13.4999 13.7102 13.6694 13.8074 13.8046 13.8576L14.1521 12.9199ZM11.4023 10.418C11.4023 9.83385 11.4811 9.26803 11.6861 8.81678L10.7757 8.40309C10.4878 9.03666 10.4023 9.76284 10.4023 10.418H11.4023ZM11.6861 8.81678C11.8053 8.55448 12.0796 8.38672 12.5813 8.38672V7.38672C11.8704 7.38672 11.1213 7.6426 10.7757 8.40309L11.6861 8.81678ZM12.5813 8.38672C13.087 8.38672 13.4614 8.60522 13.5777 8.83539L14.4703 8.38448C14.1169 7.685 13.2884 7.38672 12.5813 7.38672V8.38672ZM13.5777 8.83539C13.7606 9.19738 13.8523 9.72518 13.8523 10.418H14.8523C14.8523 9.66433 14.757 8.95213 14.4703 8.38448L13.5777 8.83539ZM12.5813 12.4492C12.5364 12.4492 12.5158 12.4464 12.5087 12.4451C12.5046 12.4444 12.5042 12.4442 12.5008 12.4428C12.4922 12.4391 12.4782 12.4321 12.438 12.4096C12.4018 12.3893 12.3471 12.358 12.2805 12.3238L11.823 13.213C11.8698 13.2371 11.9055 13.2576 11.9494 13.2821C11.9893 13.3045 12.0449 13.3354 12.1079 13.3623C12.2569 13.426 12.403 13.4492 12.5813 13.4492V12.4492ZM12.3817 12.3927C11.8273 11.9058 11.4022 11.3083 11.4023 10.418L10.4023 10.4179C10.4022 11.6973 11.0412 12.5462 11.7218 13.1441L12.3817 12.3927ZM13.8523 10.418C13.8523 11.3319 13.4575 11.9093 12.8838 12.3828L13.5203 13.1541C14.2611 12.5427 14.8523 11.7035 14.8523 10.418H13.8523ZM12.9733 12.3238C12.7638 12.4316 12.717 12.4492 12.5813 12.4492V13.4492C12.9639 13.4492 13.1869 13.3385 13.4308 13.213L12.9733 12.3238Z",fill:"currentColor"})),wt=e=>G.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},G.createElement("path",{d:"M12.002 21L11.8275 21.4686C11.981 21.5257 12.1528 21.5041 12.2873 21.4106C12.4218 21.3172 12.502 21.1638 12.502 21H12.002ZM3.89502 17.9823H3.39502C3.39502 18.1912 3.52485 18.378 3.72059 18.4509L3.89502 17.9823ZM3.89502 8.06421L4.07193 7.59655C3.91831 7.53844 3.74595 7.55948 3.61082 7.65284C3.47568 7.74619 3.39502 7.89997 3.39502 8.06421H3.89502ZM12.0007 21H11.5007C11.5007 21.1638 11.5809 21.3172 11.7154 21.4106C11.8499 21.5041 12.0216 21.5257 12.1751 21.4686L12.0007 21ZM20.1076 17.9823L20.282 18.4509C20.4778 18.378 20.6076 18.1912 20.6076 17.9823H20.1076ZM20.1076 8.06421H20.6076C20.6076 7.89997 20.527 7.74619 20.3918 7.65284C20.2567 7.55948 20.0843 7.53844 19.9307 7.59655L20.1076 8.06421ZM12.0007 11.1311L11.8238 10.6634C11.6293 10.737 11.5007 10.9232 11.5007 11.1311H12.0007ZM20.2858 8.53191C20.5441 8.43421 20.6743 8.14562 20.5766 7.88734C20.4789 7.62906 20.1903 7.49889 19.932 7.5966L20.2858 8.53191ZM12.002 4.94826L12.1775 4.48008C12.0605 4.43623 11.9314 4.43775 11.8154 4.48436L12.002 4.94826ZM5.87955 6.87106C5.62334 6.97407 5.49915 7.26528 5.60217 7.52149C5.70518 7.77769 5.99639 7.90188 6.2526 7.79887L5.87955 6.87106ZM18.1932 7.80315C18.4518 7.90008 18.74 7.76904 18.8369 7.51047C18.9338 7.2519 18.8028 6.96371 18.5442 6.86678L18.1932 7.80315ZM12 4.94827L11.5879 5.23148C11.6812 5.36719 11.8353 5.44827 12 5.44827C12.1647 5.44827 12.3188 5.36719 12.4121 5.23148L12 4.94827ZM14.0263 2L14.2028 1.53218C13.9875 1.45097 13.7446 1.52717 13.6143 1.71679L14.0263 2ZM21.8421 4.94827L22.2673 5.2113C22.3459 5.08422 22.3636 4.92863 22.3154 4.78717C22.2673 4.64571 22.1584 4.53319 22.0186 4.48045L21.8421 4.94827ZM9.97368 2L10.3857 1.71679C10.2554 1.52717 10.0125 1.45097 9.79721 1.53218L9.97368 2ZM2.15789 4.94827L1.98142 4.48045C1.84161 4.53319 1.73271 4.64571 1.68456 4.78717C1.63641 4.92863 1.65406 5.08422 1.73267 5.2113L2.15789 4.94827ZM12 11.1256L11.6702 11.5014C11.8589 11.667 12.1411 11.667 12.3298 11.5014L12 11.1256ZM15.0395 8.45812L14.8732 7.98659C14.8131 8.00779 14.7576 8.04028 14.7097 8.08232L15.0395 8.45812ZM23 5.65024L23.3288 6.0269C23.5095 5.86916 23.5527 5.60532 23.4318 5.39817C23.3109 5.19102 23.0599 5.09893 22.8337 5.17871L23 5.65024ZM8.96053 8.45812L9.29034 8.08232C9.24244 8.04028 9.18695 8.00779 9.12685 7.98659L8.96053 8.45812ZM1 5.65024L1.16632 5.17871C0.940115 5.09893 0.689119 5.19102 0.568192 5.39817C0.447264 5.60532 0.49048 5.86916 0.671176 6.0269L1 5.65024ZM12.1764 20.5314L4.06945 17.5137L3.72059 18.4509L11.8275 21.4686L12.1764 20.5314ZM4.39502 17.9823V8.06421H3.39502V17.9823H4.39502ZM3.71811 8.53187L11.8251 11.5987L12.1789 10.6634L4.07193 7.59655L3.71811 8.53187ZM11.502 11.1311V21H12.502V11.1311H11.502ZM12.1751 21.4686L20.282 18.4509L19.9332 17.5137L11.8262 20.5314L12.1751 21.4686ZM20.6076 17.9823V8.06421H19.6076V17.9823H20.6076ZM19.9307 7.59655L11.8238 10.6634L12.1776 11.5987L20.2845 8.53187L19.9307 7.59655ZM11.5007 11.1311V21H12.5007V11.1311H11.5007ZM19.932 7.5966L11.8251 10.6634L12.1789 11.5987L20.2858 8.53191L19.932 7.5966ZM11.8154 4.48436L5.87955 6.87106L6.2526 7.79887L12.1885 5.41217L11.8154 4.48436ZM11.8265 5.41645L18.1932 7.80315L18.5442 6.86678L12.1775 4.48008L11.8265 5.41645ZM11.502 4.94826V11.1311H12.502V4.94826H11.502ZM12.4121 5.23148L14.4384 2.28321L13.6143 1.71679L11.5879 4.66507L12.4121 5.23148ZM13.8498 2.46782L21.6656 5.4161L22.0186 4.48045L14.2028 1.53218L13.8498 2.46782ZM21.4169 4.68525L20.5485 6.08919L21.3989 6.61524L22.2673 5.2113L21.4169 4.68525ZM12.4121 4.66507L10.3857 1.71679L9.56162 2.28321L11.5879 5.23148L12.4121 4.66507ZM9.79721 1.53218L1.98142 4.48045L2.33437 5.4161L10.1502 2.46782L9.79721 1.53218ZM1.73267 5.2113L2.60109 6.61524L3.45154 6.08919L2.58312 4.68525L1.73267 5.2113ZM12.3298 11.5014L15.3693 8.83392L14.7097 8.08232L11.6702 10.7498L12.3298 11.5014ZM15.2058 8.92965L23.1663 6.12177L22.8337 5.17871L14.8732 7.98659L15.2058 8.92965ZM22.6712 5.27358L19.7764 7.80067L20.4341 8.554L23.3288 6.0269L22.6712 5.27358ZM12.3298 10.7498L9.29034 8.08232L8.63072 8.83392L11.6702 11.5014L12.3298 10.7498ZM9.12685 7.98659L1.16632 5.17871L0.83368 6.12177L8.79421 8.92965L9.12685 7.98659ZM0.671176 6.0269L3.56591 8.554L4.22356 7.80067L1.32882 5.27358L0.671176 6.0269Z",fill:"currentColor"})),xe=({selectable:e,className:s,addNewAddress:n,minifiedView:r,routeAddressesPage:d})=>{const o=r?"minifiedView":"fullSizeView",i=se({viewAllAddressesButton:`Account.${o}.Addresses.viewAllAddressesButton`,addNewAddressButton:`Account.${o}.Addresses.addNewAddressButton`,differentAddressButton:`Account.${o}.Addresses.differentAddressButton`}),l=e?"span":"button",f=e?{}:{AriaRole:"button",type:"button"},c=r&&!n?i.viewAllAddressesButton:i.addNewAddressButton,p=e?i.differentAddressButton:c;return j(l,{...f,className:K(["account-actions-address",["account-actions-address--viewall",r],["account-actions-address--address",!r],["account-actions-address--selectable",e],s]),"data-testid":"showRouteFullAddress",onClick:d,children:[a("span",{className:"account-actions-address__title","data-testid":"addressActionsText",children:p}),a(Ve,{source:r&&!n?xt:It,size:"32"})]})},Ht=({minifiedView:e,keysSortOrder:s,addressData:n,open:r,submitLoading:d,onRemoveAddress:o,closeModal:i})=>{const l=e?"minifiedView":"fullSizeView",f=se({title:`Account.${l}.Addresses.removeAddressModal.title`,description:`Account.${l}.Addresses.removeAddressModal.description`,actionCancel:`Account.${l}.Addresses.removeAddressModal.actionCancel`,actionConfirm:`Account.${l}.Addresses.removeAddressModal.actionConfirm`});return r?a(tt,{className:"account-address-modal--overlay",title:a("h3",{children:f.title}),size:"full","data-testid":"addressModal",showCloseButton:!0,onClose:i,children:j("div",{className:"account-address-modal",children:[d?a("div",{className:"account-address-modal__spinner","data-testid":"progressSpinner",children:a(rt,{stroke:"4",size:"large"})}):null,a("p",{children:f.description}),a(ye,{minifiedView:e,addressData:n,keysSortOrder:s}),j("div",{className:"account-address-modal__buttons",children:[a(de,{type:"button",onClick:i,variant:"secondary",disabled:d,children:f.actionCancel}),a(de,{disabled:d,onClick:o,children:f.actionConfirm})]})]})}):null},Rt=({typeList:e,isEmpty:s,minifiedView:n,className:r})=>{const d=n?"minifiedView":"fullSizeView",o=se({addressesMessage:`Account.${d}.EmptyList.Addresses.message`,ordersListMessage:`Account.${d}.EmptyList.OrdersList.message`}),i=Ce(()=>{switch(e){case"address":return{icon:Bt,text:a("p",{children:o.addressesMessage})};case"orders":return{icon:wt,text:a("p",{children:o.ordersListMessage})};default:return{icon:"",text:""}}},[e,o]);return!s||!e||!i.text?null:a(st,{className:K(["account-empty-list",n?"account-empty-list--minified":"",r]),message:i.text,icon:a(Ve,{source:i.icon}),"data-testid":"emptyList"})},Vt=async(e,s)=>{if(s.length===1){const i=s[0],f=Object.values(i.region).every(p=>!!p)?{}:{region:{...i.region,regionId:0}};return!!await be({addressId:Number(i==null?void 0:i.id),defaultShipping:!1,defaultBilling:!1,...f})}const n=s.filter(i=>i.id!==e&&(i.defaultBilling||i.defaultShipping)||i.id!==e),r=s[s.length-1],d=n[0]||((r==null?void 0:r.id)!==e?r:null);return!d||!d.id?!1:!!await be({addressId:+d.id,defaultShipping:!0,defaultBilling:!0})},zt=["firstname","lastname","city","company","country_code","region","region_code","region_id","telephone","id","vat_id","postcode","street","street_multiline_2","default_shipping","default_billing","fax","prefix","suffix","middlename"],or=["email","firstname","lastname","middlename","gender","dob","prefix","suffix","fax"],Pe=(e,s,n)=>{if(s&&n||!s&&!n)return e;const r=e.slice();return s?r.sort((d,o)=>Number(o.defaultShipping)-Number(d.defaultShipping)):n?r.sort((d,o)=>Number(o.defaultBilling)-Number(d.defaultBilling)):e},ve=e=>e==null?!0:typeof e!="object"?!1:Object.keys(e).length===0||Object.values(e).every(ve),kt=({selectShipping:e,selectBilling:s,defaultSelectAddressId:n,onAddressData:r,minifiedView:d,routeAddressesPage:o,onSuccess:i})=>{const[l,f]=x(""),[c,p]=x(!1),[L,O]=x(!1),[v,C]=x(!1),[T,Z]=x(!1),[t,m]=x(!1),[A,N]=x(""),[g,w]=x([]),[h,B]=x([]),z=U(async()=>{C(!0),Promise.all([Ue("shortRequest"),dt()]).then(_=>{const[b,S]=_;if(b){const H=b.map(({name:y,orderNumber:R,label:V})=>({name:ot(y),orderNumber:R,label:zt.includes(y)?null:V}));B(H)}if(S)if(d){const H=S.filter(R=>!!R.defaultShipping||!!R.defaultBilling),y=H.length?H:S.slice(-1);w(y)}else w(S)}).finally(()=>{C(!1)})},[d]);te(()=>{z()},[z]),te(()=>{var _;if(g.length)if(n===0)m(!0),f("0");else{const b=g.find(H=>+H.id===n)||Pe(g,e,s)[0],S={data:ae(b),isDataValid:!ve(b)};f(n.toString()||((_=b==null?void 0:b.id)==null?void 0:_.toString())),r==null||r(S)}},[g,n,r,s,e]);const E=U(_=>{N(_),m(!1)},[]),k=U((_,b)=>{const S=(_==null?void 0:_.target).value,H=(_==null?void 0:_.target).nextSibling;f(S);const y={data:ae(b),isDataValid:!ve(ae(b))};r==null||r(y),m(S==="0"),H&&(H.focus(),window.scrollBy(0,100))},[r]),W=U(()=>{O(!0)},[]),u=U(()=>{N(""),O(!1),p(!1)},[]),$=U(()=>{p(!0)},[]),M=U(async()=>{Z(!0),await Vt(A,g),lt(+A).then(()=>{z(),u()}).finally(()=>{Z(!1)})},[g,A,u,z]),F=U(()=>{m(!1)},[]),I=U(()=>{je(o)&&d&&!t?window.location.href=o():(m(!0),N(""))},[t,o,d]),q=U(async()=>{await z(),await(i==null?void 0:i())},[z,i]);return{keysSortOrder:h,submitLoading:T,isModalRendered:c,isFormRendered:L,loading:v,addNewAddress:t,addressesList:g,addressId:A,handleRenderForm:W,handleRenderModal:$,removeAddress:M,onCloseBtnClick:u,setEditingAddressId:E,closeNewAddressForm:F,redirectToAddressesRoute:I,handleOnSuccess:q,handleSelectAddressOption:k,selectedAddressOption:l}},lr=Me(({minifiedViewKey:e,hideActionFormButtons:s=!1,inputName:n,slots:r,title:d="",addressFormTitle:o="",defaultSelectAddressId:i="",showFormLoader:l=!1,onAddressData:f,forwardFormRef:c,className:p,showSaveCheckBox:L=!1,saveCheckBoxValue:O=!1,selectShipping:v=!1,selectBilling:C=!1,selectable:T=!1,withHeader:Z=!0,minifiedView:t=!1,withActionsInMinifiedView:m=!1,withActionsInFullSizeView:A=!0,inputsDefaultValueSet:N,showShippingCheckBox:g=!0,showBillingCheckBox:w=!0,shippingCheckBoxValue:h=!0,billingCheckBoxValue:B=!0,routeAddressesPage:z,onSubmit:E,onSuccess:k,onError:W})=>{const u=se({containerTitle:`Account.${e}.Addresses.containerTitle`,differentAddressFormTitle:`Account.${e}.Addresses.differentAddressFormTitle`,editAddressFormTitle:`Account.${e}.Addresses.editAddressFormTitle`,viewAllAddressesButton:`Account.${e}.Addresses.viewAllAddressesButton`,newAddressFormTitle:`Account.${e}.Addresses.newAddressFormTitle`,ariaLabelAddressPicker:`Account.${e}.Addresses.ariaLabelAddressPicker`}),{keysSortOrder:$,submitLoading:M,isModalRendered:F,isFormRendered:I,loading:q,addNewAddress:_,addressesList:b,addressId:S,handleRenderForm:H,handleRenderModal:y,removeAddress:R,onCloseBtnClick:V,handleOnSuccess:J,setEditingAddressId:Y,closeNewAddressForm:X,redirectToAddressesRoute:ie,handleSelectAddressOption:$e,selectedAddressOption:_e}=kt({defaultSelectAddressId:i,minifiedView:t,routeAddressesPage:z,onSuccess:k,onAddressData:f,selectShipping:v,selectBilling:C}),ce=d||u.containerTitle;let me=null;if(T){const Q=Pe(b,v,C)||[];let ne;_?ne=a("div",{className:K(["account-addresses-form__footer__wrapper",["account-addresses-form__footer__wrapper-show",_]]),children:a(pe,{slots:r,hideActionFormButtons:s,formName:n,showFormLoader:l,isOpen:_,forwardFormRef:c,showSaveCheckBox:L,saveCheckBoxValue:O,shippingCheckBoxValue:h,billingCheckBoxValue:B,addressesFormTitle:o||u.differentAddressFormTitle,inputsDefaultValueSet:N,showShippingCheckBox:g,showBillingCheckBox:w,onCloseBtnClick:X,onChange:f,onError:W,onSubmit:E,onSuccess:J})}):Q.length?ne=a(xe,{selectable:T,minifiedView:t,addNewAddress:_,routeAddressesPage:ie}):ne=null;const Ee=`generalLabel_${ce.replace(/\s+/g,"")}`;me=j("div",{className:"account-addresses-wrapper--select-view",children:[a("span",{id:Ee,style:"display: none;",children:ce}),Q.map((ee,Je)=>{const Le=`${n}_${ee.id}`,Ne=`${Le}_label`;return j(Ze,{children:[a("input",{"data-testid":`radio-${Je+1}`,type:"radio",name:n,id:Le,value:ee.id,checked:_e===(ee==null?void 0:ee.id.toString()),onChange:Ke=>$e(Ke,ee),"aria-labelledby":`${Ee} ${Ne}`}),a("label",{id:Ne,htmlFor:Le,className:"account-addresses-wrapper__label",children:a(ye,{slots:r,selectable:T,selectShipping:v,selectBilling:C,minifiedView:t,addressData:ee,keysSortOrder:$,loading:q})})]},ee.id)}),ne&&j("div",{className:"account-addresses-wrapper__footer-section",children:[a("input",{"aria-label":`${ce} ${u.ariaLabelAddressPicker}`,"data-testid":"radio-0",type:"radio",name:n,id:`${n}_addressActions`,value:"0",checked:_e==="0",onChange:ee=>$e(ee,{}),tabindex:ne?0:-1}),a("label",{htmlFor:`${n}_addressActions`,className:"account-addresses-wrapper__label",children:ne})]})]})}else me=j(D,{children:[b.map(Q=>a(Ze,{children:S===Q.id&&I?a(Ae,{variant:"secondary",style:{marginBottom:20},children:a(pe,{slots:r,isOpen:S===Q.id&&I,addressFormId:S,inputsDefaultValueSet:Q,addressesFormTitle:u.editAddressFormTitle,showShippingCheckBox:g,showBillingCheckBox:w,shippingCheckBoxValue:h,billingCheckBoxValue:B,forwardFormRef:c,onCloseBtnClick:V,onChange:f,onError:W,onSubmit:E,onSuccess:J})}):a(ye,{slots:r,minifiedView:t,addressData:Q,keysSortOrder:$,loading:q,setAddressId:Y,handleRenderModal:t&&m||!t&&A?y:void 0,handleRenderForm:t&&m||!t&&A?H:void 0},Q.id)},Q.id)),a("div",{className:"account-addresses__footer",children:_?a(Ae,{variant:"secondary",children:a(pe,{slots:r,isOpen:_,addressesFormTitle:u.newAddressFormTitle,inputsDefaultValueSet:N,showShippingCheckBox:!!(b!=null&&b.length),showBillingCheckBox:!!(b!=null&&b.length),shippingCheckBoxValue:h,billingCheckBoxValue:B,forwardFormRef:c,onChange:f,onCloseBtnClick:X,onError:W,onSubmit:E,onSuccess:J})}):a(xe,{minifiedView:t,addNewAddress:_,routeAddressesPage:ie})})]});return j("div",{children:[Z?a(nt,{title:ce,divider:!t,className:t?"account-addresses-header":""}):null,j("div",{className:K(["account-addresses-wrapper",p]),"data-testid":"addressesIdWrapper",children:[a(Ht,{minifiedView:t,addressData:b==null?void 0:b.find(Q=>Q.id===S),keysSortOrder:$,submitLoading:M,open:F,closeModal:V,onRemoveAddress:R}),q?a(We,{testId:"addressSkeletonLoader",withCard:!1}):T?a(pe,{slots:r,hideActionFormButtons:s,formName:n,isOpen:!(b!=null&&b.length),forwardFormRef:c,showSaveCheckBox:L,saveCheckBoxValue:O,shippingCheckBoxValue:h,billingCheckBoxValue:B,inputsDefaultValueSet:N,showShippingCheckBox:g,showBillingCheckBox:w,onChange:f,onCloseBtnClick:X,onError:W,onSubmit:E,onSuccess:J}):a(Rt,{isEmpty:!(b!=null&&b.length),typeList:"address",minifiedView:t}),me]})]})}),Ge={entityType:"CUSTOMER_ADDRESS",isUnique:!1,options:[],multilineCount:0,validateRules:[],defaultValue:!1,fieldType:re.BOOLEAN,className:"",required:!1,orderNumber:90,isHidden:!1},Ut={...Ge,label:"Set as default shipping address",name:"default_shipping",id:"default_shipping",code:"default_shipping",customUpperCode:"defaultShipping"},qt={...Ge,label:"Set as default billing address",name:"default_billing",id:"default_billing",code:"default_billing",customUpperCode:"defaultBilling"},jt=(e,s)=>s==null?void 0:s.map(n=>{const r={...e,firstName:e.firstname??e.firstName,lastName:e.lastname??e.lastName,middleName:e.middlename??e.middleName},d=JSON.parse(JSON.stringify(n));if(Object.hasOwn(r,n.customUpperCode)){const o=r[n.customUpperCode];n.customUpperCode==="region"&&typeof o=="object"?d.defaultValue=o.regionCode&&o.regionId?`${o.regionCode},${o.regionId}`:o.region??o.regionCode:d.defaultValue=o}return d}),Be=e=>{if(!e)return null;const s=new FormData(e);if(e.querySelectorAll('input[type="checkbox"]').forEach(r=>{s.has(r.name)||s.set(r.name,"false"),r.checked&&s.set(r.name,"true")}),s&&typeof s.entries=="function"){const r=s.entries();if(r&&typeof r[Symbol.iterator]=="function")return JSON.parse(JSON.stringify(Object.fromEntries(r)))||{}}return{}},Wt=({fields:e,addressId:s,countryOptions:n,disableField:r,regionOptions:d,isRequiredRegion:o,isRequiredPostCode:i})=>e.filter(f=>!(s&&(f.customUpperCode==="defaultShipping"||f.customUpperCode==="defaultBilling")&&f.defaultValue)).map(f=>f.customUpperCode==="countryCode"?{...f,options:n,disabled:r}:f.customUpperCode==="postcode"?{...f,required:i}:f.customUpperCode==="region"?{...f,options:d,required:o,disabled:r}:f),Pt=(e,s="address")=>{const n=s==="address"?["region","city","company","countryCode","countryId","defaultBilling","defaultShipping","fax","firstName","lastName","middleName","postcode","prefix","street","suffix","telephone","vatId","addressId"]:["email","firstName","lastName","middleName","gender","dob","prefix","suffix","fax"],r={},d=[];return Object.keys(e).forEach(o=>{n.includes(o)?r[o]=e[o]:d.push({attribute_code:ke(o),value:e[o]})}),d.length>0&&(r.custom_attributesV2=d),r},we=e=>{const s=["street","streetMultiline_1","streetMultiline_2"],n=["on","off","true","false"],r=[],d={};for(const C in e){const T=e[C];n.includes(T)&&(d[C]=qe(T)),s.includes(C)&&r.push(T)}const{street:o,streetMultiline_2:i,streetMultiline_1:l,region:f,...c}=e,[p,L]=f?f.split(","):[void 0,void 0],O=L&&p?{regionId:+L,regionCode:p}:{region:p};return Pt({...c,...d,region:{...O},street:r})},Gt=(e,s)=>{const n={};for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)){const d=e[r];if(r==="region"&&d.regionId){const o=s.find(i=>(i==null?void 0:i.id)===d.regionId);o?n[r]={...d,text:o.text}:n[r]=d}else Array.isArray(d)?(n[r]=d[0]||"",d.slice(1).forEach((o,i)=>{n[`${r}Multiline_${i+2}`]=o})):n[r]=d}return n},Jt=(e,s)=>e&&Object.keys(e).length>0?e:s&&Object.keys(s).length>0?s:{},Kt=({showFormLoader:e,showSaveCheckBox:s,saveCheckBoxValue:n,addressFormId:r,billingCheckBoxValue:d,shippingCheckBoxValue:o,showShippingCheckBox:i,showBillingCheckBox:l,inputsDefaultValueSet:f,onCloseBtnClick:c,onSuccess:p,onError:L,formName:O})=>{const[v,C]=x({text:"",type:"success"}),[T,Z]=x(e??!1),[t,m]=x(r||""),[A,N]=x([]),[g,w]=x(null),[h,B]=x(()=>{var R,V;const y=sessionStorage.getItem(`${O}_addressData`);return y?{countryCode:(V=(R=JSON.parse(y))==null?void 0:R.data)==null?void 0:V.countryCode}:f}),[z,E]=x(!1),[k,W]=x(()=>{var V,J;const y=sessionStorage.getItem(`${O}_addressData`);return y?(J=(V=JSON.parse(y))==null?void 0:V.data)==null?void 0:J.saveAddressBook:n}),u=U(y=>{W(y.target.checked)},[]);te(()=>{typeof e>"u"||Z(e)},[e]),te(()=>{Ue(t?"customer_address_edit":"customer_register_address").then(y=>{N(y)})},[t]),te(()=>{E(!0),it().then(({availableCountries:y,countriesWithRequiredRegion:R,optionalZipCountries:V})=>{w({availableCountries:y,countriesWithRequiredRegion:R,optionalZipCountries:V}),E(!1)})},[]);const $=oe(()=>(g==null?void 0:g.availableCountries)||[],[g]),M=oe(()=>!(h!=null&&h.countryCode)||!g?!1:g.countriesWithRequiredRegion.includes(h.countryCode),[h==null?void 0:h.countryCode,g]),F=oe(()=>!(h!=null&&h.countryCode)||!g?!0:!g.optionalZipCountries.includes(h.countryCode),[h==null?void 0:h.countryCode,g]),I=oe(()=>{var R;if(!(h!=null&&h.countryCode)||!g)return[];const y=g.availableCountries.find(V=>V.value===h.countryCode);return((R=y==null?void 0:y.availableRegions)==null?void 0:R.map(V=>({text:V.name,value:`${V.code},${V.id}`})))||[]},[h==null?void 0:h.countryCode,g]),q=U(()=>{C({text:"",type:"success"}),c==null||c()},[c]),_=U(async(y,R)=>{if(!R)return null;Z(!0);const V=Be(y.target),J=we(V);await be(J).then(()=>{var Y;p==null||p(),c==null||c(),(Y=y==null?void 0:y.target)==null||Y.reset()}).catch(Y=>{C(X=>({...X,text:Y.message,type:"error"})),L==null||L(Y)}).finally(()=>{m(""),Z(!1)})},[c,L,p]),b=U(async(y,R)=>{if(!R)return;Z(!0);const{saveAddressBook:V,...J}=Be(y.target),Y=we(J);await ct(Y).then(()=>{var X;p==null||p(),c==null||c(),(X=y==null?void 0:y.target)==null||X.reset()}).catch(X=>{C(ie=>({...ie,text:X.message,type:"error"})),L==null||L(X)}).finally(()=>{m(""),Z(!1)})},[c,L,p]),S=oe(()=>{if(!A.length)return[];const y={...Ut,defaultValue:o??!1,isHidden:s&&!k?!0:!i},R={...qt,defaultValue:d??!1,isHidden:s&&!k?!0:!l},V=[...A,y,R],J=sessionStorage.getItem(`${O}_addressData`),Y=J?Gt(JSON.parse(J).data,I):{},X=jt(Jt(Y,f),V);return Wt({fields:X,addressId:t,countryOptions:$,disableField:z,regionOptions:I,isRequiredRegion:M,isRequiredPostCode:F})},[A,o,s,k,i,d,l,O,I,f,t,$,z,M,F]),H=U(y=>{B(R=>({...R,...y}))},[]);return{regionOptions:I,saveCheckBoxAddress:k,inLineAlert:v,addressId:t,submitLoading:T,normalizeFieldsConfig:S,handleSaveCheckBoxAddress:u,handleUpdateAddress:_,handleCreateAddress:b,handleOnCloseForm:q,handleInputChange:H}},Xt=e=>{var d;if(!e||!Array.isArray(e.customAttributes))return e??{};const s={};(d=e==null?void 0:e.customAttributes)==null||d.forEach(o=>{o.code&&Object.hasOwn(o,"value")&&(s[o.code]=o.value)});const{customAttributes:n,...r}=e;return{...r,...ze(s,"camelCase",{})}},Yt=({hideActionFormButtons:e,formName:s="",showFormLoader:n=!1,showSaveCheckBox:r=!1,saveCheckBoxValue:d=!1,forwardFormRef:o,slots:i,addressesFormTitle:l,className:f,addressFormId:c,inputsDefaultValueSet:p,showShippingCheckBox:L=!0,showBillingCheckBox:O=!0,shippingCheckBoxValue:v=!0,billingCheckBoxValue:C=!0,isOpen:T,fieldIdPrefix:Z,onSubmit:t,onCloseBtnClick:m,onSuccess:A,onError:N,onChange:g})=>{const w=se({secondaryButton:"Account.AddressForm.formText.secondaryButton",primaryButton:"Account.AddressForm.formText.primaryButton",saveAddressBook:"Account.AddressForm.formText.saveAddressBook"}),{inLineAlert:h,addressId:B,submitLoading:z,normalizeFieldsConfig:E,handleUpdateAddress:k,handleCreateAddress:W,handleOnCloseForm:u,handleSaveCheckBoxAddress:$,saveCheckBoxAddress:M,handleInputChange:F,regionOptions:I}=Kt({showFormLoader:n,addressFormId:c,inputsDefaultValueSet:Xt(p),shippingCheckBoxValue:v,billingCheckBoxValue:C,showShippingCheckBox:L,showBillingCheckBox:O,saveCheckBoxValue:d,showSaveCheckBox:r,onSuccess:A,onError:N,onCloseBtnClick:m,formName:s}),[q,_]=x(0);return te(()=>{_(b=>b+1)},[p]),T?j("div",{className:K(["account-address-form-wrapper",f]),children:[l?a("div",{className:"account-address-form-wrapper__title","data-testid":"addressesFormTitle",children:l}):null,h.text?a(at,{"data-testid":"inLineAlert",className:"account-address-form-wrapper__notification",type:h.type,variant:"secondary",heading:h.text,icon:h.icon}):null,j(Ft,{regionOptions:I,forwardFormRef:o,slots:i,className:"account-address-form",name:s||"addressesForm",fieldsConfig:E,onSubmit:t||(B?k:W),setInputChange:F,loading:z,showFormLoader:n,showSaveCheckBox:r,handleSaveCheckBoxAddress:$,saveCheckBoxAddress:M,onChange:g,fieldIdPrefix:Z,children:[B?a("input",{type:"hidden",name:"addressId",value:B,"data-testid":"hidden_test_id"}):null,e?null:a("div",{className:K(["dropin-field account-address-form-wrapper__buttons",["account-address-form-wrapper__buttons--empty",r]]),children:i!=null&&i.AddressFormActions?a(he,{"data-testid":"addressFormActions",name:"AddressFormActions",slot:i.AddressFormActions,context:{handleUpdateAddress:k,handleCreateAddress:W,addressId:B}}):a(D,{children:r?null:j(D,{children:[a(de,{type:"button",onClick:u,variant:"secondary",disabled:z,children:w.secondaryButton}),a(de,{disabled:z,children:w.primaryButton})]})})})]},q)]}):null};export{pe as A,We as C,Rt as E,Ft as F,xt as S,lr as a,je as c,or as d,Be as g,Pt as n};
//# sourceMappingURL=AddressValidation.js.map
