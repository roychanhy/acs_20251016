{"version":3,"file":"recaptcha.js","sources":["@dropins/tools/src/recaptcha/configs/message.config.ts","@dropins/tools/src/recaptcha/configs/typeForms.config.ts","@dropins/tools/src/recaptcha/configs/recaptchaBadgeSelector.config.ts","@dropins/tools/src/recaptcha/lib/_extendConfig.ts","@dropins/tools/src/recaptcha/lib/_storageConfig.ts","@dropins/tools/src/recaptcha/lib/_checkRecaptchaBadge.ts","@dropins/tools/src/recaptcha/lib/_convertKeysToCamelCase.ts","@dropins/tools/src/recaptcha/services/recaptcha.service.ts","@dropins/tools/src/recaptcha/graphql/recaptchaConfig.graphql.ts","@dropins/tools/src/recaptcha/index.ts"],"sourcesContent":["/********************************************************************\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\nexport const recaptchaMessage = {\n  failedFetch: 'Failed to fetch config from backend with status:',\n  failedSetStorageConfig: 'Failed to set storage config',\n  failedGetStorageConfig: 'Configuration could not be loaded.',\n  failedExecutionRecaptcha: 'Recaptcha execution failed',\n  failedInitializing: 'An error occurred while initializing ReCaptcha:',\n};\n","/********************************************************************\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\nexport const typeDefaultForm: Record<string, string> = {\n  PLACE_ORDER: 'placeOrder',\n  CONTACT: 'contactUs',\n  CUSTOMER_LOGIN: 'generateCustomerToken',\n  CUSTOMER_FORGOT_PASSWORD: 'requestPasswordResetEmail',\n  CUSTOMER_CREATE: 'createCustomerV2',\n  CUSTOMER_EDIT: 'updateCustomerV2',\n  NEWSLETTER: 'subscribeEmailToNewsletter',\n  PRODUCT_REVIEW: 'createProductReview',\n  SENDFRIEND: 'SENDFRIEND',\n  BRAINTREE: 'BRAINTREE',\n};\n","/********************************************************************\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\nexport const recaptchaBadgeSelector = '.grecaptcha-badge iframe';","/********************************************************************\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\nimport { ReCaptchaV3Model } from '../types/recaptcha.types';\nimport { typeDefaultForm } from '../configs/typeForms.config';\n\nexport const extendConfig = (\n  config: ReCaptchaV3Model,\n  modifyParams: any[]\n): ReCaptchaV3Model | undefined => {\n  if (config && config.forms) {\n    const modifyForm = config.forms.concat(modifyParams).map((el) => {\n      if (typeof el !== 'string') return { ...el, enabledBadgePlace: false };\n\n      return {\n        badgeId: typeDefaultForm[el],\n        enabledBadgePlace: false,\n      };\n    });\n\n    return { ...config, forms: [...new Set(modifyForm)] };\n  }\n};\n","/********************************************************************\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\nimport { recaptchaMessage } from '../configs';\nimport { ReCaptchaV3Model } from '../types/recaptcha.types';\n\nconst getConfigStorage = async (\n  storageKey: string,\n  retries = 1,\n  delay = 1000\n): Promise<ReCaptchaV3Model | null> => {\n  const storedConfig = sessionStorage.getItem(storageKey);\n\n  if (storedConfig !== null) {\n    return JSON.parse(storedConfig);\n  } else if (retries > 0) {\n    await new Promise((resolve) => setTimeout(resolve, delay));\n\n    return getConfigStorage(storageKey, retries - 1, delay);\n  }\n\n  return null;\n};\n\nconst setConfigStorage = (\n  storageKey: string,\n  config: ReCaptchaV3Model,\n  logger: boolean\n) => {\n  if (!storageKey || !config.websiteKey) return null;\n\n  try {\n    sessionStorage.setItem(storageKey, JSON.stringify(config));\n  } catch (error) {\n    logger && console.error(recaptchaMessage.failedSetStorageConfig, error);\n    return null;\n  }\n};\n\nexport { getConfigStorage, setConfigStorage };\n","/********************************************************************\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\nimport { recaptchaBadgeSelector } from '../configs';\n\nconst waitForElement = (selector: string): Promise<void> => {\n  return new Promise((resolve, reject) => {\n    try {\n      // Check if the element is already in the DOM\n      if (document.querySelector(selector)) {\n        resolve();\n        return;\n      }\n\n      // Create an observer to watch for changes\n      const observer = new MutationObserver(() => {\n        if (document.querySelector(selector)) {\n          resolve();\n          observer.disconnect();\n        }\n      });\n\n      // Start observing the body for child changes only\n      observer.observe(document.body, {\n        childList: true,\n        subtree: false,\n      });\n    } catch (error) {\n      reject(error);\n    }\n  });\n};\n\nexport const checkRecaptchaBadge = async (): Promise<boolean> => {\n  try {\n    await waitForElement(recaptchaBadgeSelector);\n    return true;\n  } catch (error) {\n    return false;\n  }\n};\n","/********************************************************************\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\nexport const convertKeysToCamelCase = (obj: {\n  [key: string]: any;\n}): { [key: string]: string | number | boolean } => {\n  const camelCaseKey = (key: string): string => {\n    return key.replace(/_([a-z])/g, (_, letter) => letter.toUpperCase());\n  };\n\n  return Object.keys(obj).reduce((result, key) => {\n    const newKey = camelCaseKey(key);\n    result[newKey] = obj[key];\n    return result;\n  }, {} as { [key: string]: any });\n};\n","/********************************************************************\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\nimport { recaptchaMessage } from '../configs';\nimport {\n  MutationObserverInit,\n  ReCaptchaV3Model,\n} from '../types/recaptcha.types';\nconst { failedExecutionRecaptcha } = recaptchaMessage;\n\nexport const getRecaptchaToken = async (\n  websiteKey: string\n): Promise<string> => {\n  if (!(window as any).grecaptcha) {\n    return Promise.reject(failedExecutionRecaptcha);\n  }\n\n  try {\n    const token = await window.grecaptcha.execute(websiteKey, {\n      action: 'click',\n    });\n\n    return token;\n  } catch (error) {\n    return Promise.reject(`${failedExecutionRecaptcha} : ${error}`);\n  }\n};\n\nexport const waitForReCaptcha = () => {\n  return new Promise((resolve) => {\n    const observer = new MutationObserver((_, obs) => {\n      if (window.grecaptcha) {\n        obs.disconnect();\n        resolve(true);\n      }\n    });\n\n    const observerOptions: MutationObserverInit = {\n      childList: true,\n      subtree: true,\n      attributes: true,\n    };\n\n    observer.observe(document.body, observerOptions);\n  });\n};\n\nexport const verifyReCaptchaLoad = async (\n  badgeId: string,\n  config: ReCaptchaV3Model,\n  logger: boolean\n): Promise<void> => {\n  if (!window.grecaptcha) {\n    await waitForReCaptcha();\n  }\n\n  return grecaptcha.ready(() => {\n    const badgeContainers = document.querySelectorAll(`#${badgeId}`);\n\n    if (!badgeContainers.length) return;\n\n    // Handle the case when multiple instances of the drop-in container rendered on the same page\n\n    badgeContainers.forEach(\n      (element) => (element.id = `${element.id}_${Math.random().toString(36)}`) // NOSONAR\n    );\n\n    badgeContainers.forEach((element) => {\n      if (element.innerHTML === '') {\n        try {\n          grecaptcha.render(element.id, {\n            sitekey: config.websiteKey as string,\n            badge: config.badgePosition,\n            size: 'invisible',\n            theme: config.theme ?? 'light',\n          });\n        } catch (error) {\n          logger && console.error(error);\n        }\n      }\n    });\n  });\n};\n","/********************************************************************\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\nexport const RECAPTCHA_CONFIGURATION_V3 = `query {\n  recaptchaV3Config {\n    is_enabled\n    website_key\n    minimum_score\n    badge_position\n    language_code\n    failure_message\n    forms\n    theme\n  } \n}`;\n","/********************************************************************\n *  Copyright 2024 Adobe\n *  All Rights Reserved.\n *\n * NOTICE:  Adobe permits you to use, modify, and distribute this \n * file in accordance with the terms of the Adobe license agreement \n * accompanying it. \n *******************************************************************/\n\nimport {\n  ReCaptchaV3Response,\n  PropsFormTypes,\n  ReCaptchaV3Model,\n} from './types/recaptcha.types';\nimport { recaptchaMessage, recaptchaBadgeSelector } from './configs';\nimport {\n  extendConfig,\n  setConfigStorage,\n  getConfigStorage,\n  checkRecaptchaBadge,\n  convertKeysToCamelCase,\n} from './lib';\nimport {\n  getRecaptchaToken,\n  verifyReCaptchaLoad,\n} from './services/recaptcha.service';\nimport { RECAPTCHA_CONFIGURATION_V3 } from './graphql/recaptchaConfig.graphql';\n\nimport { FetchGraphQL } from '@adobe-commerce/fetch-graphql';\n\nexport const recaptchaFetchApi = new FetchGraphQL().getMethods();\n\nexport class RecaptchaModule {\n  _enableReCAPTCHA: boolean = false;\n  _recaptchaBackendEndpoint: string =\n    recaptchaFetchApi.getConfig()?.endpoint || '';\n  _recaptchaScriptUrl: string = 'https://www.google.com/recaptcha/api.js';\n  _configStorageKey: string = 'recaptchaConfig';\n  _logger: boolean = false;\n\n  async _updateBadgePosition(\n    badgeId: string,\n    config: ReCaptchaV3Model\n  ): Promise<void | null> {\n    if (!config) return;\n\n    if (config?.badgePosition === 'inline') {\n      await verifyReCaptchaLoad(badgeId, config, this._logger);\n    } else {\n      const isBadgeLoaded = await checkRecaptchaBadge();\n\n      if (!isBadgeLoaded) return;\n\n      const recaptchaBadge = document.querySelector(\n        recaptchaBadgeSelector\n      ) as HTMLIFrameElement;\n\n      const shouldUpdateSrc =\n        config.theme &&\n        recaptchaBadge &&\n        !recaptchaBadge.src.includes('theme=dark') &&\n        !recaptchaBadge.src.includes('theme=light');\n\n      if (shouldUpdateSrc) {\n        recaptchaBadge.setAttribute(\n          'src',\n          `${recaptchaBadge.src}&theme=${config.theme}`\n        );\n      }\n    }\n  }\n\n  async _addRecaptchaScript(): Promise<void> {\n    const config = await this._loadConfig();\n\n    if (!document.getElementById('recaptchaId') && config) {\n      const webApiKey = config.websiteKey;\n      const isBadgeGlobal = config.badgePosition === 'inline';\n      const languageCode = config.languageCode;\n\n      if (!webApiKey) return;\n\n      const script = document.createElement('script');\n      script.setAttribute('id', 'recaptchaId');\n      script.defer = true;\n      script.src = isBadgeGlobal\n        ? `${this._recaptchaScriptUrl}?render=${webApiKey}&badge=none&hl=${languageCode}`\n        : `${this._recaptchaScriptUrl}?render=${webApiKey}&badge=${config.badgePosition}&hl=${languageCode}`;\n\n      document.head.appendChild(script);\n    }\n  }\n\n  async _fetchStoreConfig(): Promise<ReCaptchaV3Response | undefined> {\n    try {\n      const response = await recaptchaFetchApi.fetchGraphQl(\n        RECAPTCHA_CONFIGURATION_V3,\n        {\n          method: 'GET',\n          cache: 'force-cache',\n        }\n      );\n\n      if (response?.errors?.length) {\n        this._logger && console.error(response.errors[0].message);\n\n        return;\n      }\n\n      return response;\n    } catch (error) {\n      this._logger && console.error(`${recaptchaMessage.failedFetch}:`, error);\n    }\n  }\n\n  async _loadConfig(): Promise<ReCaptchaV3Model | null> {\n    const config = await getConfigStorage(this._configStorageKey);\n\n    if (!config) {\n      this._logger && console.error(recaptchaMessage.failedGetStorageConfig);\n\n      return null;\n    }\n\n    this._enableReCAPTCHA = !!config.isEnabled;\n\n    return config;\n  }\n\n  setEndpoint(url: string) {\n    if (!url) return;\n\n    this._recaptchaBackendEndpoint = url;\n    recaptchaFetchApi.setEndpoint(url);\n  }\n\n  async setConfig(configList: PropsFormTypes[]) {\n    try {\n      const config = await this._fetchStoreConfig();\n\n      if (!config?.data?.recaptchaV3Config) {\n        sessionStorage.removeItem(this._configStorageKey);\n        return;\n      }\n\n      const transformConfig: ReCaptchaV3Model = convertKeysToCamelCase(\n        config?.data?.recaptchaV3Config\n      );\n\n      const extendedRecaptchaConfig = extendConfig(transformConfig, configList);\n\n      if (extendedRecaptchaConfig) {\n        setConfigStorage(\n          this._configStorageKey,\n          extendedRecaptchaConfig,\n          this._logger\n        );\n      }\n    } catch (error) {\n      this._logger &&\n        console.error(recaptchaMessage.failedSetStorageConfig, error);\n\n      sessionStorage.removeItem(this._configStorageKey);\n    }\n  }\n\n  async initReCaptcha(lazyLoadTimeout = 3000) {\n    // IIFE added to fix SonarQube error \"Promise returned in function argument where a void return was expected\"\n    setTimeout(() => {\n      (async () => {\n        try {\n          const config = await this._loadConfig();\n\n          if (!config?.forms || !config.isEnabled) {\n            return;\n          }\n\n          await this._addRecaptchaScript();\n\n          if (config.badgePosition === 'inline') {\n            await Promise.all(\n              (config.forms as PropsFormTypes[]).map((element) =>\n                this._updateBadgePosition(element.badgeId, config)\n              )\n            );\n          } else {\n            await this._updateBadgePosition('', config);\n          }\n        } catch (error) {\n          this._logger &&\n            console.error(recaptchaMessage.failedInitializing, error);\n        }\n      })();\n    }, lazyLoadTimeout);\n  }\n\n  async verifyReCaptcha(): Promise<string | undefined> {\n    try {\n      const config = await this._loadConfig();\n\n      if (!config?.forms || !config.websiteKey || !config.isEnabled) {\n        return undefined;\n      }\n\n      return await getRecaptchaToken(config.websiteKey);\n    } catch (error) {\n      this._logger && console.error(error);\n    }\n  }\n\n  enableLogger(logger: boolean) {\n    this._logger = logger;\n  }\n\n  getMethods() {\n    return {\n      enableLogger: this.enableLogger.bind(this),\n      setEndpoint: this.setEndpoint.bind(this),\n      setConfig: this.setConfig.bind(this),\n      initReCaptcha: this.initReCaptcha.bind(this),\n      verifyReCaptcha: this.verifyReCaptcha.bind(this),\n    };\n  }\n}\n\nconst recaptcha = new RecaptchaModule();\n\nconst { initReCaptcha, verifyReCaptcha, setEndpoint, setConfig, enableLogger } =\n  recaptcha.getMethods();\n\nexport { setEndpoint, setConfig, initReCaptcha, verifyReCaptcha, enableLogger };\n"],"names":["recaptchaMessage","typeDefaultForm","recaptchaBadgeSelector","extendConfig","config","modifyParams","modifyForm","el","getConfigStorage","storageKey","retries","delay","storedConfig","resolve","setConfigStorage","logger","error","waitForElement","selector","reject","observer","checkRecaptchaBadge","convertKeysToCamelCase","obj","camelCaseKey","key","_","letter","result","newKey","failedExecutionRecaptcha","getRecaptchaToken","websiteKey","waitForReCaptcha","obs","observerOptions","verifyReCaptchaLoad","badgeId","badgeContainers","element","RECAPTCHA_CONFIGURATION_V3","recaptchaFetchApi","FetchGraphQL","RecaptchaModule","_a","recaptchaBadge","webApiKey","isBadgeGlobal","languageCode","script","response","url","configList","transformConfig","_b","extendedRecaptchaConfig","lazyLoadTimeout","recaptcha","initReCaptcha","verifyReCaptcha","setEndpoint","setConfig","enableLogger"],"mappings":"kDASO,MAAMA,EAAmB,CAC9B,YAAa,mDACb,uBAAwB,+BACxB,uBAAwB,qCACxB,yBAA0B,6BAC1B,mBAAoB,iDACtB,ECNaC,EAA0C,CACrD,YAAa,aACb,QAAS,YACT,eAAgB,wBAChB,yBAA0B,4BAC1B,gBAAiB,mBACjB,cAAe,mBACf,WAAY,6BACZ,eAAgB,sBAChB,WAAY,aACZ,UAAW,WACb,ECXaC,EAAyB,2BCGzBC,EAAe,CAC1BC,EACAC,IACiC,CAC7B,GAAAD,GAAUA,EAAO,MAAO,CACpB,MAAAE,EAAaF,EAAO,MAAM,OAAOC,CAAY,EAAE,IAAKE,GACpD,OAAOA,GAAO,SAAiB,CAAE,GAAGA,EAAI,kBAAmB,EAAM,EAE9D,CACL,QAASN,EAAgBM,CAAE,EAC3B,kBAAmB,EACrB,CACD,EAEM,MAAA,CAAE,GAAGH,EAAQ,MAAO,CAAC,GAAG,IAAI,IAAIE,CAAU,CAAC,CAAE,CAAA,CAExD,EChBME,EAAmB,MACvBC,EACAC,EAAU,EACVC,EAAQ,MAC6B,CAC/B,MAAAC,EAAe,eAAe,QAAQH,CAAU,EAEtD,OAAIG,IAAiB,KACZ,KAAK,MAAMA,CAAY,EACrBF,EAAU,GACnB,MAAM,IAAI,QAASG,GAAY,WAAWA,EAASF,CAAK,CAAC,EAElDH,EAAiBC,EAAYC,EAAU,EAAGC,CAAK,GAGjD,IACT,EAEMG,EAAmB,CACvBL,EACAL,EACAW,IACG,CACH,GAAI,CAACN,GAAc,CAACL,EAAO,WAAmB,OAAA,KAE1C,GAAA,CACF,eAAe,QAAQK,EAAY,KAAK,UAAUL,CAAM,CAAC,QAClDY,EAAO,CACd,OAAAD,GAAU,QAAQ,MAAMf,EAAiB,uBAAwBgB,CAAK,EAC/D,IAAA,CAEX,EChCMC,EAAkBC,GACf,IAAI,QAAQ,CAACL,EAASM,IAAW,CAClC,GAAA,CAEE,GAAA,SAAS,cAAcD,CAAQ,EAAG,CAC5BL,EAAA,EACR,MAAA,CAII,MAAAO,EAAW,IAAI,iBAAiB,IAAM,CACtC,SAAS,cAAcF,CAAQ,IACzBL,EAAA,EACRO,EAAS,WAAW,EACtB,CACD,EAGQA,EAAA,QAAQ,SAAS,KAAM,CAC9B,UAAW,GACX,QAAS,EAAA,CACV,QACMJ,EAAO,CACdG,EAAOH,CAAK,CAAA,CACd,CACD,EAGUK,EAAsB,SAA8B,CAC3D,GAAA,CACF,aAAMJ,EAAef,CAAsB,EACpC,QACO,CACP,MAAA,EAAA,CAEX,ECrCaoB,EAA0BC,GAEa,CAC5C,MAAAC,EAAgBC,GACbA,EAAI,QAAQ,YAAa,CAACC,EAAGC,IAAWA,EAAO,aAAa,EAGrE,OAAO,OAAO,KAAKJ,CAAG,EAAE,OAAO,CAACK,EAAQH,IAAQ,CACxC,MAAAI,EAASL,EAAaC,CAAG,EACxB,OAAAG,EAAAC,CAAM,EAAIN,EAAIE,CAAG,EACjBG,CACT,EAAG,EAA4B,CACjC,ECPM,CAAE,yBAAAE,CAA6B,EAAA9B,EAExB+B,EAAoB,MAC/BC,GACoB,CAChB,GAAA,CAAE,OAAe,WACZ,OAAA,QAAQ,OAAOF,CAAwB,EAG5C,GAAA,CAKK,OAJO,MAAM,OAAO,WAAW,QAAQE,EAAY,CACxD,OAAQ,OAAA,CACT,QAGMhB,EAAO,CACd,OAAO,QAAQ,OAAO,GAAGc,CAAwB,MAAMd,CAAK,EAAE,CAAA,CAElE,EAEaiB,EAAmB,IACvB,IAAI,QAASpB,GAAY,CAC9B,MAAMO,EAAW,IAAI,iBAAiB,CAACM,EAAGQ,IAAQ,CAC5C,OAAO,aACTA,EAAI,WAAW,EACfrB,EAAQ,EAAI,EACd,CACD,EAEKsB,EAAwC,CAC5C,UAAW,GACX,QAAS,GACT,WAAY,EACd,EAESf,EAAA,QAAQ,SAAS,KAAMe,CAAe,CAAA,CAChD,EAGUC,EAAsB,MACjCC,EACAjC,EACAW,KAEK,OAAO,YACV,MAAMkB,EAAiB,EAGlB,WAAW,MAAM,IAAM,CAC5B,MAAMK,EAAkB,SAAS,iBAAiB,IAAID,CAAO,EAAE,EAE1DC,EAAgB,SAILA,EAAA,QACbC,GAAaA,EAAQ,GAAK,GAAGA,EAAQ,EAAE,IAAI,KAAK,OAAA,EAAS,SAAS,EAAE,CAAC,EACxE,EAEgBD,EAAA,QAASC,GAAY,CAC/B,GAAAA,EAAQ,YAAc,GACpB,GAAA,CACS,WAAA,OAAOA,EAAQ,GAAI,CAC5B,QAASnC,EAAO,WAChB,MAAOA,EAAO,cACd,KAAM,YACN,MAAOA,EAAO,OAAS,OAAA,CACxB,QACMY,EAAO,CACJD,GAAA,QAAQ,MAAMC,CAAK,CAAA,CAEjC,CACD,EAAA,CACF,GC9EUwB,EAA6B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GCqB7BC,EAAoB,IAAIC,EAAa,EAAE,WAAW,EAExD,MAAMC,CAAgB,CAAtB,aAAA,OACuB,KAAA,iBAAA,GAE1B,KAAA,4BAAAC,EAAAH,EAAkB,UAAU,IAA5B,YAAAG,EAA+B,WAAY,GACf,KAAA,oBAAA,0CACF,KAAA,kBAAA,kBACT,KAAA,QAAA,EAAA,CAEnB,MAAM,qBACJP,EACAjC,EACsB,CACtB,GAAKA,EAED,IAAAA,GAAA,YAAAA,EAAQ,iBAAkB,SAC5B,MAAMgC,EAAoBC,EAASjC,EAAQ,KAAK,OAAO,MAClD,CAGL,GAAI,CAFkB,MAAMiB,EAAoB,EAE5B,OAEpB,MAAMwB,EAAiB,SAAS,cAC9B3C,CACF,EAGEE,EAAO,OACPyC,GACA,CAACA,EAAe,IAAI,SAAS,YAAY,GACzC,CAACA,EAAe,IAAI,SAAS,aAAa,GAG3BA,EAAA,aACb,MACA,GAAGA,EAAe,GAAG,UAAUzC,EAAO,KAAK,EAC7C,CACF,CACF,CAGF,MAAM,qBAAqC,CACnC,MAAAA,EAAS,MAAM,KAAK,YAAY,EAEtC,GAAI,CAAC,SAAS,eAAe,aAAa,GAAKA,EAAQ,CACrD,MAAM0C,EAAY1C,EAAO,WACnB2C,EAAgB3C,EAAO,gBAAkB,SACzC4C,EAAe5C,EAAO,aAE5B,GAAI,CAAC0C,EAAW,OAEV,MAAAG,EAAS,SAAS,cAAc,QAAQ,EACvCA,EAAA,aAAa,KAAM,aAAa,EACvCA,EAAO,MAAQ,GACfA,EAAO,IAAMF,EACT,GAAG,KAAK,mBAAmB,WAAWD,CAAS,kBAAkBE,CAAY,GAC7E,GAAG,KAAK,mBAAmB,WAAWF,CAAS,UAAU1C,EAAO,aAAa,OAAO4C,CAAY,GAE3F,SAAA,KAAK,YAAYC,CAAM,CAAA,CAClC,CAGF,MAAM,mBAA8D,OAC9D,GAAA,CACI,MAAAC,EAAW,MAAMT,EAAkB,aACvCD,EACA,CACE,OAAQ,MACR,MAAO,aAAA,CAEX,EAEI,IAAAI,EAAAM,GAAA,YAAAA,EAAU,SAAV,MAAAN,EAAkB,OAAQ,CAC5B,KAAK,SAAW,QAAQ,MAAMM,EAAS,OAAO,CAAC,EAAE,OAAO,EAExD,MAAA,CAGK,OAAAA,QACAlC,EAAO,CACd,KAAK,SAAW,QAAQ,MAAM,GAAGhB,EAAiB,WAAW,IAAKgB,CAAK,CAAA,CACzE,CAGF,MAAM,aAAgD,CACpD,MAAMZ,EAAS,MAAMI,EAAiB,KAAK,iBAAiB,EAE5D,OAAKJ,GAMA,KAAA,iBAAmB,CAAC,CAACA,EAAO,UAE1BA,IAPL,KAAK,SAAW,QAAQ,MAAMJ,EAAiB,sBAAsB,EAE9D,KAKF,CAGT,YAAYmD,EAAa,CAClBA,IAEL,KAAK,0BAA4BA,EACjCV,EAAkB,YAAYU,CAAG,EAAA,CAGnC,MAAM,UAAUC,EAA8B,SACxC,GAAA,CACI,MAAAhD,EAAS,MAAM,KAAK,kBAAkB,EAExC,GAAA,GAACwC,EAAAxC,GAAA,YAAAA,EAAQ,OAAR,MAAAwC,EAAc,mBAAmB,CACrB,eAAA,WAAW,KAAK,iBAAiB,EAChD,MAAA,CAGF,MAAMS,EAAoC/B,GACxCgC,EAAAlD,GAAA,YAAAA,EAAQ,OAAR,YAAAkD,EAAc,iBAChB,EAEMC,EAA0BpD,EAAakD,EAAiBD,CAAU,EAEpEG,GACFzC,EACE,KAAK,kBACLyC,EACA,KAAK,OACP,QAEKvC,EAAO,CACd,KAAK,SACH,QAAQ,MAAMhB,EAAiB,uBAAwBgB,CAAK,EAE/C,eAAA,WAAW,KAAK,iBAAiB,CAAA,CAClD,CAGF,MAAM,cAAcwC,EAAkB,IAAM,CAE1C,WAAW,IAAM,EACd,SAAY,CACP,GAAA,CACI,MAAApD,EAAS,MAAM,KAAK,YAAY,EAEtC,GAAI,EAACA,GAAA,MAAAA,EAAQ,QAAS,CAACA,EAAO,UAC5B,OAGF,MAAM,KAAK,oBAAoB,EAE3BA,EAAO,gBAAkB,SAC3B,MAAM,QAAQ,IACXA,EAAO,MAA2B,IAAKmC,GACtC,KAAK,qBAAqBA,EAAQ,QAASnC,CAAM,CAAA,CAErD,EAEM,MAAA,KAAK,qBAAqB,GAAIA,CAAM,QAErCY,EAAO,CACd,KAAK,SACH,QAAQ,MAAMhB,EAAiB,mBAAoBgB,CAAK,CAAA,CAC5D,GACC,GACFwC,CAAe,CAAA,CAGpB,MAAM,iBAA+C,CAC/C,GAAA,CACI,MAAApD,EAAS,MAAM,KAAK,YAAY,EAElC,MAAA,EAACA,GAAA,MAAAA,EAAQ,QAAS,CAACA,EAAO,YAAc,CAACA,EAAO,UAC3C,OAGF,MAAM2B,EAAkB3B,EAAO,UAAU,QACzCY,EAAO,CACT,KAAA,SAAW,QAAQ,MAAMA,CAAK,CAAA,CACrC,CAGF,aAAaD,EAAiB,CAC5B,KAAK,QAAUA,CAAA,CAGjB,YAAa,CACJ,MAAA,CACL,aAAc,KAAK,aAAa,KAAK,IAAI,EACzC,YAAa,KAAK,YAAY,KAAK,IAAI,EACvC,UAAW,KAAK,UAAU,KAAK,IAAI,EACnC,cAAe,KAAK,cAAc,KAAK,IAAI,EAC3C,gBAAiB,KAAK,gBAAgB,KAAK,IAAI,CACjD,CAAA,CAEJ,CAEA,MAAM0C,EAAY,IAAId,EAEhB,CAAE,cAAAe,EAAe,gBAAAC,EAAiB,YAAAC,EAAa,UAAAC,EAAW,aAAAC,CAAa,EAC3EL,EAAU,WAAW"}